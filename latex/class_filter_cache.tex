\hypertarget{class_filter_cache}{}\doxysection{Filter\+Cache Class Reference}
\label{class_filter_cache}\index{FilterCache@{FilterCache}}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_filter_cache_a01f051d4654d2e0d8bb344cf3111b4be}{Filter\+Cache}} ()
\item 
bool \mbox{\hyperlink{class_filter_cache_a47fdf15e198bf751e5cce596e8abcbdf}{get\+File\+Contents}} (const \mbox{\hyperlink{class_q_c_string}{QCString}} \&file\+Name, \mbox{\hyperlink{class_buf_str}{Buf\+Str}} \&str)
\item 
\mbox{\hyperlink{class_filter_cache_a01f051d4654d2e0d8bb344cf3111b4be}{Filter\+Cache}} ()
\item 
bool \mbox{\hyperlink{class_filter_cache_a47fdf15e198bf751e5cce596e8abcbdf}{get\+File\+Contents}} (const \mbox{\hyperlink{class_q_c_string}{QCString}} \&file\+Name, \mbox{\hyperlink{class_buf_str}{Buf\+Str}} \&str)
\end{DoxyCompactItemize}
\doxysubsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
std\+::unordered\+\_\+map$<$ \mbox{\hyperlink{libmscgen_2gd_8h_a13690c1a2aacb1c8261e3be3c4a4f4b2}{std\+::string}}, \mbox{\hyperlink{struct_filter_cache_item}{Filter\+Cache\+Item}} $>$ \mbox{\hyperlink{class_filter_cache_a0af0e0a5434ae8a1225de2f2a3210078}{m\+\_\+cache}}
\item 
\mbox{\hyperlink{build_2doxygen_2src_2portable_8h_a25423a5b429a3ee0610315d93938bd0b}{portable\+\_\+off\+\_\+t}} \mbox{\hyperlink{class_filter_cache_a5ef8cdbd8e0b997aeeb92777ff5fc965}{m\+\_\+end\+Pos}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\mbox{\hyperlink{class_cache}{Cache}} for storing the result of filtering a file 

Definition at line \mbox{\hyperlink{build_2doxygen_2src_2definition_8cpp_source_l00587}{587}} of file \mbox{\hyperlink{build_2doxygen_2src_2definition_8cpp_source}{definition.\+cpp}}.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_filter_cache_a01f051d4654d2e0d8bb344cf3111b4be}\label{class_filter_cache_a01f051d4654d2e0d8bb344cf3111b4be}} 
\index{FilterCache@{FilterCache}!FilterCache@{FilterCache}}
\index{FilterCache@{FilterCache}!FilterCache@{FilterCache}}
\doxysubsubsection{\texorpdfstring{FilterCache()}{FilterCache()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily Filter\+Cache\+::\+Filter\+Cache (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{build_2doxygen_2src_2definition_8cpp_source_l00590}{590}} of file \mbox{\hyperlink{build_2doxygen_2src_2definition_8cpp_source}{definition.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00590 : \mbox{\hyperlink{class_filter_cache_a5ef8cdbd8e0b997aeeb92777ff5fc965}{m\_endPos}}(0) \{ \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_filter_cache_a01f051d4654d2e0d8bb344cf3111b4be}\label{class_filter_cache_a01f051d4654d2e0d8bb344cf3111b4be}} 
\index{FilterCache@{FilterCache}!FilterCache@{FilterCache}}
\index{FilterCache@{FilterCache}!FilterCache@{FilterCache}}
\doxysubsubsection{\texorpdfstring{FilterCache()}{FilterCache()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily Filter\+Cache\+::\+Filter\+Cache (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{src_2definition_8cpp_source_l00590}{590}} of file \mbox{\hyperlink{src_2definition_8cpp_source}{definition.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00590 : \mbox{\hyperlink{class_filter_cache_a5ef8cdbd8e0b997aeeb92777ff5fc965}{m\_endPos}}(0) \{ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_filter_cache_a47fdf15e198bf751e5cce596e8abcbdf}\label{class_filter_cache_a47fdf15e198bf751e5cce596e8abcbdf}} 
\index{FilterCache@{FilterCache}!getFileContents@{getFileContents}}
\index{getFileContents@{getFileContents}!FilterCache@{FilterCache}}
\doxysubsubsection{\texorpdfstring{getFileContents()}{getFileContents()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily bool Filter\+Cache\+::get\+File\+Contents (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_q_c_string}{QCString}} \&}]{file\+Name,  }\item[{\mbox{\hyperlink{class_buf_str}{Buf\+Str}} \&}]{str }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{build_2doxygen_2src_2definition_8cpp_source_l00591}{591}} of file \mbox{\hyperlink{build_2doxygen_2src_2definition_8cpp_source}{definition.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00592     \{}
\DoxyCodeLine{00593       \textcolor{keywordtype}{bool} filterSourceFiles = \mbox{\hyperlink{build_2doxygen_2src_2config_8h_a5373d0332a31f16ad7a42037733e8c79}{Config\_getBool}}(FILTER\_SOURCE\_FILES);}
\DoxyCodeLine{00594       \mbox{\hyperlink{class_q_c_string}{QCString}} \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_ac48c7cc368d341ab2c1c9ec3fab9c273}{filter}} = \mbox{\hyperlink{build_2doxygen_2src_2util_8cpp_ad4426e053bb11589c58bd5c6828817e2}{getFileFilter}}(fileName,\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}});}
\DoxyCodeLine{00595       \textcolor{keywordtype}{bool} usePipe = !\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_ac48c7cc368d341ab2c1c9ec3fab9c273}{filter}}.isEmpty() \&\& filterSourceFiles;}
\DoxyCodeLine{00596       FILE *\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}}=0;}
\DoxyCodeLine{00597       \textcolor{keyword}{const} \textcolor{keywordtype}{int} blockSize = 4096;}
\DoxyCodeLine{00598       \textcolor{keywordtype}{char} buf[blockSize];}
\DoxyCodeLine{00599       \textcolor{keyword}{auto} it = \mbox{\hyperlink{class_filter_cache_a0af0e0a5434ae8a1225de2f2a3210078}{m\_cache}}.find(fileName.\mbox{\hyperlink{class_q_c_string_a875e9ad762554ef12f3ed69b015bb245}{str}}());}
\DoxyCodeLine{00600       \textcolor{keywordflow}{if} (usePipe \&\& it!=\mbox{\hyperlink{class_filter_cache_a0af0e0a5434ae8a1225de2f2a3210078}{m\_cache}}.end()) \textcolor{comment}{// cache hit: reuse stored result}}
\DoxyCodeLine{00601       \{}
\DoxyCodeLine{00602         \textcolor{keyword}{auto} item = it-\/>second;}
\DoxyCodeLine{00603         \textcolor{comment}{//printf("{}getFileContents(\%s): cache hit\(\backslash\)n"{},qPrint(fileName));}}
\DoxyCodeLine{00604         \textcolor{comment}{// file already processed, get the results after filtering from the tmp file}}
\DoxyCodeLine{00605         \mbox{\hyperlink{class_debug_a5d86ffebf96f9f75b6c957db5f831da3}{Debug::print}}(\mbox{\hyperlink{class_debug_a9e0b892a8030a4f64076850777991c96adeaa5931452b9cc0cbfad497d71c093b}{Debug::FilterOutput}},0,\textcolor{stringliteral}{"{}Reusing filter result for \%s from \%s at offset=\%lld size=\%zu\(\backslash\)n"{}},}
\DoxyCodeLine{00606                \mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(fileName),\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(\mbox{\hyperlink{class_doxygen_a076ed5b2ed20d6f9a7d3a7adc9049f09}{Doxygen::filterDBFileName}}),item.filePos,item.fileSize);}
\DoxyCodeLine{00607         \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}} = \mbox{\hyperlink{namespace_portable_a4dbb08c3de409bd1a73be3da6d93ac57}{Portable::fopen}}(\mbox{\hyperlink{class_doxygen_a076ed5b2ed20d6f9a7d3a7adc9049f09}{Doxygen::filterDBFileName}},\textcolor{stringliteral}{"{}rb"{}});}
\DoxyCodeLine{00608         \textcolor{keywordflow}{if} (\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}})}
\DoxyCodeLine{00609         \{}
\DoxyCodeLine{00610           \textcolor{keywordtype}{bool} success=\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}};}
\DoxyCodeLine{00611           str.\mbox{\hyperlink{class_buf_str_af4bda58a1b9cbf4f33fe3d247502e1f4}{resize}}(\textcolor{keyword}{static\_cast<}\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a4d3943ddea65db7163a58e6c7e8df95a}{uint}}\textcolor{keyword}{>}(item.fileSize+1));}
\DoxyCodeLine{00612           \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespace_portable_a508bfa22b32f24c3920ab65097fd9d59}{Portable::fseek}}(\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}},item.filePos,SEEK\_SET)==-\/1)}
\DoxyCodeLine{00613           \{}
\DoxyCodeLine{00614             \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_aede5746344fdce99647541101eaa7f06}{err}}(\textcolor{stringliteral}{"{}Failed to seek to position \%d in filter database file \%s\(\backslash\)n"{}},\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(item.filePos),\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(\mbox{\hyperlink{class_doxygen_a076ed5b2ed20d6f9a7d3a7adc9049f09}{Doxygen::filterDBFileName}}));}
\DoxyCodeLine{00615             success=\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}};}
\DoxyCodeLine{00616           \}}
\DoxyCodeLine{00617           \textcolor{keywordflow}{if} (success)}
\DoxyCodeLine{00618           \{}
\DoxyCodeLine{00619             \textcolor{keywordtype}{size\_t} numBytes = fread(str.\mbox{\hyperlink{class_buf_str_a38f1315046acdef23cab4dc53c6eda2b}{data}}(),1,item.fileSize,\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}});}
\DoxyCodeLine{00620             \textcolor{keywordflow}{if} (numBytes!=item.fileSize)}
\DoxyCodeLine{00621             \{}
\DoxyCodeLine{00622               \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_aede5746344fdce99647541101eaa7f06}{err}}(\textcolor{stringliteral}{"{}Failed to read \%zu bytes from position \%d in filter database file \%s: got \%zu bytes\(\backslash\)n"{}},}
\DoxyCodeLine{00623                  item.fileSize,\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(item.filePos),\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(\mbox{\hyperlink{class_doxygen_a076ed5b2ed20d6f9a7d3a7adc9049f09}{Doxygen::filterDBFileName}}),numBytes);}
\DoxyCodeLine{00624               success=\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}};}
\DoxyCodeLine{00625             \}}
\DoxyCodeLine{00626           \}}
\DoxyCodeLine{00627           str.\mbox{\hyperlink{class_buf_str_a36ec062edea86b33b794eeab37f32b1c}{addChar}}(\textcolor{charliteral}{'\(\backslash\)0'});}
\DoxyCodeLine{00628           \mbox{\hyperlink{namespace_portable_af099fa6239b4961887192d8eadfd2a44}{fclose}}(\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}});}
\DoxyCodeLine{00629           \textcolor{keywordflow}{return} success;}
\DoxyCodeLine{00630         \}}
\DoxyCodeLine{00631         \textcolor{keywordflow}{else}}
\DoxyCodeLine{00632         \{}
\DoxyCodeLine{00633           \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_aede5746344fdce99647541101eaa7f06}{err}}(\textcolor{stringliteral}{"{}Failed to open filter database file \%s\(\backslash\)n"{}},\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(\mbox{\hyperlink{class_doxygen_a076ed5b2ed20d6f9a7d3a7adc9049f09}{Doxygen::filterDBFileName}}));}
\DoxyCodeLine{00634           \textcolor{keywordflow}{return} \mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}};}
\DoxyCodeLine{00635         \}}
\DoxyCodeLine{00636       \}}
\DoxyCodeLine{00637       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (usePipe) \textcolor{comment}{// cache miss: filter active but file not previously processed}}
\DoxyCodeLine{00638       \{}
\DoxyCodeLine{00639         \textcolor{comment}{//printf("{}getFileContents(\%s): cache miss\(\backslash\)n"{},qPrint(fileName));}}
\DoxyCodeLine{00640         \textcolor{comment}{// filter file}}
\DoxyCodeLine{00641         \mbox{\hyperlink{class_q_c_string}{QCString}} cmd=\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_ac48c7cc368d341ab2c1c9ec3fab9c273}{filter}}+\textcolor{stringliteral}{"{} \(\backslash\)"{}"{}}+fileName+\textcolor{stringliteral}{"{}\(\backslash\)"{}"{}};}
\DoxyCodeLine{00642         \mbox{\hyperlink{class_debug_a5d86ffebf96f9f75b6c957db5f831da3}{Debug::print}}(\mbox{\hyperlink{class_debug_a9e0b892a8030a4f64076850777991c96ae0f271a190b409433daefa05343c9eee}{Debug::ExtCmd}},0,\textcolor{stringliteral}{"{}Executing popen(`\%s`)\(\backslash\)n"{}},\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(cmd));}
\DoxyCodeLine{00643         \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}} = \mbox{\hyperlink{namespace_portable_a15b92ac03be9e8f4d95d5e881342d83c}{Portable::popen}}(cmd,\textcolor{stringliteral}{"{}r"{}});}
\DoxyCodeLine{00644         FILE *bf = \mbox{\hyperlink{namespace_portable_a4dbb08c3de409bd1a73be3da6d93ac57}{Portable::fopen}}(\mbox{\hyperlink{class_doxygen_a076ed5b2ed20d6f9a7d3a7adc9049f09}{Doxygen::filterDBFileName}},\textcolor{stringliteral}{"{}a+b"{}});}
\DoxyCodeLine{00645         \mbox{\hyperlink{struct_filter_cache_item}{FilterCacheItem}} item;}
\DoxyCodeLine{00646         item.\mbox{\hyperlink{struct_filter_cache_item_a299a11b01794a0983f310a3c0681763a}{filePos}} = \mbox{\hyperlink{class_filter_cache_a5ef8cdbd8e0b997aeeb92777ff5fc965}{m\_endPos}};}
\DoxyCodeLine{00647         \textcolor{keywordflow}{if} (bf==0)}
\DoxyCodeLine{00648         \{}
\DoxyCodeLine{00649           \textcolor{comment}{// handle error}}
\DoxyCodeLine{00650           \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_aede5746344fdce99647541101eaa7f06}{err}}(\textcolor{stringliteral}{"{}Error opening filter database file \%s\(\backslash\)n"{}},\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(\mbox{\hyperlink{class_doxygen_a076ed5b2ed20d6f9a7d3a7adc9049f09}{Doxygen::filterDBFileName}}));}
\DoxyCodeLine{00651           str.\mbox{\hyperlink{class_buf_str_a36ec062edea86b33b794eeab37f32b1c}{addChar}}(\textcolor{charliteral}{'\(\backslash\)0'});}
\DoxyCodeLine{00652           \mbox{\hyperlink{namespace_portable_a6cde8cab8c3dc3397ea5c6030fbf6e84}{Portable::pclose}}(\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}});}
\DoxyCodeLine{00653           \textcolor{keywordflow}{return} \mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}};}
\DoxyCodeLine{00654         \}}
\DoxyCodeLine{00655         \textcolor{comment}{// append the filtered output to the database file}}
\DoxyCodeLine{00656         \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a1e79fade784ffb450b103ad42e120fa0}{size}}=0;}
\DoxyCodeLine{00657         \textcolor{keywordflow}{while} (!feof(\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}}))}
\DoxyCodeLine{00658         \{}
\DoxyCodeLine{00659           \textcolor{keywordtype}{size\_t} bytesRead = fread(buf,1,blockSize,\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}});}
\DoxyCodeLine{00660           \textcolor{keywordtype}{size\_t} bytesWritten = fwrite(buf,1,bytesRead,bf);}
\DoxyCodeLine{00661           \textcolor{keywordflow}{if} (bytesRead!=bytesWritten)}
\DoxyCodeLine{00662           \{}
\DoxyCodeLine{00663             \textcolor{comment}{// handle error}}
\DoxyCodeLine{00664             \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_aede5746344fdce99647541101eaa7f06}{err}}(\textcolor{stringliteral}{"{}Failed to write to filter database \%s. Wrote \%zu out of \%zu bytes\(\backslash\)n"{}},}
\DoxyCodeLine{00665                 \mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(\mbox{\hyperlink{class_doxygen_a076ed5b2ed20d6f9a7d3a7adc9049f09}{Doxygen::filterDBFileName}}),bytesWritten,bytesRead);}
\DoxyCodeLine{00666             str.\mbox{\hyperlink{class_buf_str_a36ec062edea86b33b794eeab37f32b1c}{addChar}}(\textcolor{charliteral}{'\(\backslash\)0'});}
\DoxyCodeLine{00667             \mbox{\hyperlink{namespace_portable_a6cde8cab8c3dc3397ea5c6030fbf6e84}{Portable::pclose}}(\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}});}
\DoxyCodeLine{00668             \mbox{\hyperlink{namespace_portable_af099fa6239b4961887192d8eadfd2a44}{fclose}}(bf);}
\DoxyCodeLine{00669             \textcolor{keywordflow}{return} \mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}};}
\DoxyCodeLine{00670           \}}
\DoxyCodeLine{00671           \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a1e79fade784ffb450b103ad42e120fa0}{size}}+=bytesWritten;}
\DoxyCodeLine{00672           str.\mbox{\hyperlink{class_buf_str_a1b51ff3c6cd8c69cd32992570ef109d4}{addArray}}(buf,\textcolor{keyword}{static\_cast<}\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a4d3943ddea65db7163a58e6c7e8df95a}{uint}}\textcolor{keyword}{>}(bytesWritten));}
\DoxyCodeLine{00673         \}}
\DoxyCodeLine{00674         str.\mbox{\hyperlink{class_buf_str_a36ec062edea86b33b794eeab37f32b1c}{addChar}}(\textcolor{charliteral}{'\(\backslash\)0'});}
\DoxyCodeLine{00675         item.\mbox{\hyperlink{struct_filter_cache_item_a5e8de0dabe98585d43c628924b331507}{fileSize}} = \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a1e79fade784ffb450b103ad42e120fa0}{size}};}
\DoxyCodeLine{00676         \textcolor{comment}{// add location entry to the dictionary}}
\DoxyCodeLine{00677         \mbox{\hyperlink{class_filter_cache_a0af0e0a5434ae8a1225de2f2a3210078}{m\_cache}}.insert(std::make\_pair(fileName.str(),item));}
\DoxyCodeLine{00678         \mbox{\hyperlink{class_debug_a5d86ffebf96f9f75b6c957db5f831da3}{Debug::print}}(\mbox{\hyperlink{class_debug_a9e0b892a8030a4f64076850777991c96adeaa5931452b9cc0cbfad497d71c093b}{Debug::FilterOutput}},0,\textcolor{stringliteral}{"{}Storing new filter result for \%s in \%s at offset=\%lld size=\%zu\(\backslash\)n"{}},}
\DoxyCodeLine{00679                \mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(fileName),\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(\mbox{\hyperlink{class_doxygen_a076ed5b2ed20d6f9a7d3a7adc9049f09}{Doxygen::filterDBFileName}}),item.\mbox{\hyperlink{struct_filter_cache_item_a299a11b01794a0983f310a3c0681763a}{filePos}},item.\mbox{\hyperlink{struct_filter_cache_item_a5e8de0dabe98585d43c628924b331507}{fileSize}});}
\DoxyCodeLine{00680         \textcolor{comment}{// update end of file position}}
\DoxyCodeLine{00681         \mbox{\hyperlink{class_filter_cache_a5ef8cdbd8e0b997aeeb92777ff5fc965}{m\_endPos}} += \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a1e79fade784ffb450b103ad42e120fa0}{size}};}
\DoxyCodeLine{00682         \mbox{\hyperlink{namespace_portable_a6cde8cab8c3dc3397ea5c6030fbf6e84}{Portable::pclose}}(\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}});}
\DoxyCodeLine{00683         \mbox{\hyperlink{namespace_portable_af099fa6239b4961887192d8eadfd2a44}{fclose}}(bf);}
\DoxyCodeLine{00684       \}}
\DoxyCodeLine{00685       \textcolor{keywordflow}{else} \textcolor{comment}{// no filtering}}
\DoxyCodeLine{00686       \{}
\DoxyCodeLine{00687         \textcolor{comment}{// normal file}}
\DoxyCodeLine{00688         \textcolor{comment}{//printf("{}getFileContents(\%s): no filter\(\backslash\)n"{},qPrint(fileName));}}
\DoxyCodeLine{00689         \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}} = \mbox{\hyperlink{namespace_portable_a4dbb08c3de409bd1a73be3da6d93ac57}{Portable::fopen}}(fileName,\textcolor{stringliteral}{"{}r"{}});}
\DoxyCodeLine{00690         \textcolor{keywordflow}{while} (!feof(\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}}))}
\DoxyCodeLine{00691         \{}
\DoxyCodeLine{00692           \textcolor{keywordtype}{size\_t} bytesRead = fread(buf,1,blockSize,\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}});}
\DoxyCodeLine{00693           str.\mbox{\hyperlink{class_buf_str_a1b51ff3c6cd8c69cd32992570ef109d4}{addArray}}(buf,\textcolor{keyword}{static\_cast<}\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a4d3943ddea65db7163a58e6c7e8df95a}{uint}}\textcolor{keyword}{>}(bytesRead));}
\DoxyCodeLine{00694         \}}
\DoxyCodeLine{00695         str.\mbox{\hyperlink{class_buf_str_a36ec062edea86b33b794eeab37f32b1c}{addChar}}(\textcolor{charliteral}{'\(\backslash\)0'});}
\DoxyCodeLine{00696         \mbox{\hyperlink{namespace_portable_af099fa6239b4961887192d8eadfd2a44}{fclose}}(\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}});}
\DoxyCodeLine{00697       \}}
\DoxyCodeLine{00698       \textcolor{keywordflow}{return} \mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}};}
\DoxyCodeLine{00699     \}}

\end{DoxyCode}


References \mbox{\hyperlink{class_buf_str_a1b51ff3c6cd8c69cd32992570ef109d4}{Buf\+Str\+::add\+Array()}}, \mbox{\hyperlink{class_buf_str_a36ec062edea86b33b794eeab37f32b1c}{Buf\+Str\+::add\+Char()}}, \mbox{\hyperlink{build_2doxygen_2src_2config_8h_a5373d0332a31f16ad7a42037733e8c79}{Config\+\_\+get\+Bool}}, \mbox{\hyperlink{class_buf_str_a38f1315046acdef23cab4dc53c6eda2b}{Buf\+Str\+::data()}}, \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_aede5746344fdce99647541101eaa7f06}{err()}}, \mbox{\hyperlink{class_debug_a9e0b892a8030a4f64076850777991c96ae0f271a190b409433daefa05343c9eee}{Debug\+::\+Ext\+Cmd}}, \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}}, \mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}}, \mbox{\hyperlink{namespace_portable_af099fa6239b4961887192d8eadfd2a44}{Portable\+::fclose()}}, \mbox{\hyperlink{struct_filter_cache_item_a299a11b01794a0983f310a3c0681763a}{Filter\+Cache\+Item\+::file\+Pos}}, \mbox{\hyperlink{struct_filter_cache_item_a5e8de0dabe98585d43c628924b331507}{Filter\+Cache\+Item\+::file\+Size}}, \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_ac48c7cc368d341ab2c1c9ec3fab9c273}{filter}}, \mbox{\hyperlink{class_doxygen_a076ed5b2ed20d6f9a7d3a7adc9049f09}{Doxygen\+::filter\+DBFile\+Name}}, \mbox{\hyperlink{class_debug_a9e0b892a8030a4f64076850777991c96adeaa5931452b9cc0cbfad497d71c093b}{Debug\+::\+Filter\+Output}}, \mbox{\hyperlink{namespace_portable_a4dbb08c3de409bd1a73be3da6d93ac57}{Portable\+::fopen()}}, \mbox{\hyperlink{namespace_portable_a508bfa22b32f24c3920ab65097fd9d59}{Portable\+::fseek()}}, \mbox{\hyperlink{build_2doxygen_2src_2util_8cpp_ad4426e053bb11589c58bd5c6828817e2}{get\+File\+Filter()}}, \mbox{\hyperlink{namespace_portable_a6cde8cab8c3dc3397ea5c6030fbf6e84}{Portable\+::pclose()}}, \mbox{\hyperlink{namespace_portable_a15b92ac03be9e8f4d95d5e881342d83c}{Portable\+::popen()}}, \mbox{\hyperlink{class_debug_a5d86ffebf96f9f75b6c957db5f831da3}{Debug\+::print()}}, \mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{q\+Print()}}, \mbox{\hyperlink{class_buf_str_af4bda58a1b9cbf4f33fe3d247502e1f4}{Buf\+Str\+::resize()}}, \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a1e79fade784ffb450b103ad42e120fa0}{size}}, \mbox{\hyperlink{class_q_c_string_a875e9ad762554ef12f3ed69b015bb245}{QCString\+::str()}}, and \mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}}.



Referenced by \mbox{\hyperlink{build_2doxygen_2src_2definition_8cpp_a6333b9a697ac8f68f7d18158826461ae}{read\+Code\+Fragment()}}.

\mbox{\Hypertarget{class_filter_cache_a47fdf15e198bf751e5cce596e8abcbdf}\label{class_filter_cache_a47fdf15e198bf751e5cce596e8abcbdf}} 
\index{FilterCache@{FilterCache}!getFileContents@{getFileContents}}
\index{getFileContents@{getFileContents}!FilterCache@{FilterCache}}
\doxysubsubsection{\texorpdfstring{getFileContents()}{getFileContents()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily bool Filter\+Cache\+::get\+File\+Contents (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_q_c_string}{QCString}} \&}]{file\+Name,  }\item[{\mbox{\hyperlink{class_buf_str}{Buf\+Str}} \&}]{str }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{src_2definition_8cpp_source_l00591}{591}} of file \mbox{\hyperlink{src_2definition_8cpp_source}{definition.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00592     \{}
\DoxyCodeLine{00593       \textcolor{keywordtype}{bool} filterSourceFiles = \mbox{\hyperlink{build_2doxygen_2src_2config_8h_a5373d0332a31f16ad7a42037733e8c79}{Config\_getBool}}(FILTER\_SOURCE\_FILES);}
\DoxyCodeLine{00594       \mbox{\hyperlink{class_q_c_string}{QCString}} \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_ac48c7cc368d341ab2c1c9ec3fab9c273}{filter}} = \mbox{\hyperlink{build_2doxygen_2src_2util_8cpp_ad4426e053bb11589c58bd5c6828817e2}{getFileFilter}}(fileName,\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}});}
\DoxyCodeLine{00595       \textcolor{keywordtype}{bool} usePipe = !\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_ac48c7cc368d341ab2c1c9ec3fab9c273}{filter}}.isEmpty() \&\& filterSourceFiles;}
\DoxyCodeLine{00596       FILE *\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}}=0;}
\DoxyCodeLine{00597       \textcolor{keyword}{const} \textcolor{keywordtype}{int} blockSize = 4096;}
\DoxyCodeLine{00598       \textcolor{keywordtype}{char} buf[blockSize];}
\DoxyCodeLine{00599       \textcolor{keyword}{auto} it = \mbox{\hyperlink{class_filter_cache_a0af0e0a5434ae8a1225de2f2a3210078}{m\_cache}}.find(fileName.\mbox{\hyperlink{class_q_c_string_a875e9ad762554ef12f3ed69b015bb245}{str}}());}
\DoxyCodeLine{00600       \textcolor{keywordflow}{if} (usePipe \&\& it!=\mbox{\hyperlink{class_filter_cache_a0af0e0a5434ae8a1225de2f2a3210078}{m\_cache}}.end()) \textcolor{comment}{// cache hit: reuse stored result}}
\DoxyCodeLine{00601       \{}
\DoxyCodeLine{00602         \textcolor{keyword}{auto} item = it-\/>second;}
\DoxyCodeLine{00603         \textcolor{comment}{//printf("{}getFileContents(\%s): cache hit\(\backslash\)n"{},qPrint(fileName));}}
\DoxyCodeLine{00604         \textcolor{comment}{// file already processed, get the results after filtering from the tmp file}}
\DoxyCodeLine{00605         \mbox{\hyperlink{class_debug_a5d86ffebf96f9f75b6c957db5f831da3}{Debug::print}}(\mbox{\hyperlink{class_debug_a9e0b892a8030a4f64076850777991c96adeaa5931452b9cc0cbfad497d71c093b}{Debug::FilterOutput}},0,\textcolor{stringliteral}{"{}Reusing filter result for \%s from \%s at offset=\%lld size=\%zu\(\backslash\)n"{}},}
\DoxyCodeLine{00606                \mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(fileName),\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(\mbox{\hyperlink{class_doxygen_a076ed5b2ed20d6f9a7d3a7adc9049f09}{Doxygen::filterDBFileName}}),item.filePos,item.fileSize);}
\DoxyCodeLine{00607         \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}} = \mbox{\hyperlink{namespace_portable_a4dbb08c3de409bd1a73be3da6d93ac57}{Portable::fopen}}(\mbox{\hyperlink{class_doxygen_a076ed5b2ed20d6f9a7d3a7adc9049f09}{Doxygen::filterDBFileName}},\textcolor{stringliteral}{"{}rb"{}});}
\DoxyCodeLine{00608         \textcolor{keywordflow}{if} (\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}})}
\DoxyCodeLine{00609         \{}
\DoxyCodeLine{00610           \textcolor{keywordtype}{bool} success=\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}};}
\DoxyCodeLine{00611           str.\mbox{\hyperlink{class_buf_str_af4bda58a1b9cbf4f33fe3d247502e1f4}{resize}}(\textcolor{keyword}{static\_cast<}\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a4d3943ddea65db7163a58e6c7e8df95a}{uint}}\textcolor{keyword}{>}(item.fileSize+1));}
\DoxyCodeLine{00612           \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespace_portable_a508bfa22b32f24c3920ab65097fd9d59}{Portable::fseek}}(\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}},item.filePos,SEEK\_SET)==-\/1)}
\DoxyCodeLine{00613           \{}
\DoxyCodeLine{00614             \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_aede5746344fdce99647541101eaa7f06}{err}}(\textcolor{stringliteral}{"{}Failed to seek to position \%d in filter database file \%s\(\backslash\)n"{}},\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(item.filePos),\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(\mbox{\hyperlink{class_doxygen_a076ed5b2ed20d6f9a7d3a7adc9049f09}{Doxygen::filterDBFileName}}));}
\DoxyCodeLine{00615             success=\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}};}
\DoxyCodeLine{00616           \}}
\DoxyCodeLine{00617           \textcolor{keywordflow}{if} (success)}
\DoxyCodeLine{00618           \{}
\DoxyCodeLine{00619             \textcolor{keywordtype}{size\_t} numBytes = fread(str.\mbox{\hyperlink{class_buf_str_a38f1315046acdef23cab4dc53c6eda2b}{data}}(),1,item.fileSize,\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}});}
\DoxyCodeLine{00620             \textcolor{keywordflow}{if} (numBytes!=item.fileSize)}
\DoxyCodeLine{00621             \{}
\DoxyCodeLine{00622               \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_aede5746344fdce99647541101eaa7f06}{err}}(\textcolor{stringliteral}{"{}Failed to read \%zu bytes from position \%d in filter database file \%s: got \%zu bytes\(\backslash\)n"{}},}
\DoxyCodeLine{00623                  item.fileSize,\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(item.filePos),\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(\mbox{\hyperlink{class_doxygen_a076ed5b2ed20d6f9a7d3a7adc9049f09}{Doxygen::filterDBFileName}}),numBytes);}
\DoxyCodeLine{00624               success=\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}};}
\DoxyCodeLine{00625             \}}
\DoxyCodeLine{00626           \}}
\DoxyCodeLine{00627           str.\mbox{\hyperlink{class_buf_str_a36ec062edea86b33b794eeab37f32b1c}{addChar}}(\textcolor{charliteral}{'\(\backslash\)0'});}
\DoxyCodeLine{00628           \mbox{\hyperlink{namespace_portable_af099fa6239b4961887192d8eadfd2a44}{fclose}}(\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}});}
\DoxyCodeLine{00629           \textcolor{keywordflow}{return} success;}
\DoxyCodeLine{00630         \}}
\DoxyCodeLine{00631         \textcolor{keywordflow}{else}}
\DoxyCodeLine{00632         \{}
\DoxyCodeLine{00633           \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_aede5746344fdce99647541101eaa7f06}{err}}(\textcolor{stringliteral}{"{}Failed to open filter database file \%s\(\backslash\)n"{}},\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(\mbox{\hyperlink{class_doxygen_a076ed5b2ed20d6f9a7d3a7adc9049f09}{Doxygen::filterDBFileName}}));}
\DoxyCodeLine{00634           \textcolor{keywordflow}{return} \mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}};}
\DoxyCodeLine{00635         \}}
\DoxyCodeLine{00636       \}}
\DoxyCodeLine{00637       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (usePipe) \textcolor{comment}{// cache miss: filter active but file not previously processed}}
\DoxyCodeLine{00638       \{}
\DoxyCodeLine{00639         \textcolor{comment}{//printf("{}getFileContents(\%s): cache miss\(\backslash\)n"{},qPrint(fileName));}}
\DoxyCodeLine{00640         \textcolor{comment}{// filter file}}
\DoxyCodeLine{00641         \mbox{\hyperlink{class_q_c_string}{QCString}} cmd=\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_ac48c7cc368d341ab2c1c9ec3fab9c273}{filter}}+\textcolor{stringliteral}{"{} \(\backslash\)"{}"{}}+fileName+\textcolor{stringliteral}{"{}\(\backslash\)"{}"{}};}
\DoxyCodeLine{00642         \mbox{\hyperlink{class_debug_a5d86ffebf96f9f75b6c957db5f831da3}{Debug::print}}(\mbox{\hyperlink{class_debug_a9e0b892a8030a4f64076850777991c96ae0f271a190b409433daefa05343c9eee}{Debug::ExtCmd}},0,\textcolor{stringliteral}{"{}Executing popen(`\%s`)\(\backslash\)n"{}},\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(cmd));}
\DoxyCodeLine{00643         \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}} = \mbox{\hyperlink{namespace_portable_a15b92ac03be9e8f4d95d5e881342d83c}{Portable::popen}}(cmd,\textcolor{stringliteral}{"{}r"{}});}
\DoxyCodeLine{00644         FILE *bf = \mbox{\hyperlink{namespace_portable_a4dbb08c3de409bd1a73be3da6d93ac57}{Portable::fopen}}(\mbox{\hyperlink{class_doxygen_a076ed5b2ed20d6f9a7d3a7adc9049f09}{Doxygen::filterDBFileName}},\textcolor{stringliteral}{"{}a+b"{}});}
\DoxyCodeLine{00645         \mbox{\hyperlink{struct_filter_cache_item}{FilterCacheItem}} item;}
\DoxyCodeLine{00646         item.\mbox{\hyperlink{struct_filter_cache_item_a299a11b01794a0983f310a3c0681763a}{filePos}} = \mbox{\hyperlink{class_filter_cache_a5ef8cdbd8e0b997aeeb92777ff5fc965}{m\_endPos}};}
\DoxyCodeLine{00647         \textcolor{keywordflow}{if} (bf==0)}
\DoxyCodeLine{00648         \{}
\DoxyCodeLine{00649           \textcolor{comment}{// handle error}}
\DoxyCodeLine{00650           \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_aede5746344fdce99647541101eaa7f06}{err}}(\textcolor{stringliteral}{"{}Error opening filter database file \%s\(\backslash\)n"{}},\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(\mbox{\hyperlink{class_doxygen_a076ed5b2ed20d6f9a7d3a7adc9049f09}{Doxygen::filterDBFileName}}));}
\DoxyCodeLine{00651           str.\mbox{\hyperlink{class_buf_str_a36ec062edea86b33b794eeab37f32b1c}{addChar}}(\textcolor{charliteral}{'\(\backslash\)0'});}
\DoxyCodeLine{00652           \mbox{\hyperlink{namespace_portable_a6cde8cab8c3dc3397ea5c6030fbf6e84}{Portable::pclose}}(\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}});}
\DoxyCodeLine{00653           \textcolor{keywordflow}{return} \mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}};}
\DoxyCodeLine{00654         \}}
\DoxyCodeLine{00655         \textcolor{comment}{// append the filtered output to the database file}}
\DoxyCodeLine{00656         \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a1e79fade784ffb450b103ad42e120fa0}{size}}=0;}
\DoxyCodeLine{00657         \textcolor{keywordflow}{while} (!feof(\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}}))}
\DoxyCodeLine{00658         \{}
\DoxyCodeLine{00659           \textcolor{keywordtype}{size\_t} bytesRead = fread(buf,1,blockSize,\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}});}
\DoxyCodeLine{00660           \textcolor{keywordtype}{size\_t} bytesWritten = fwrite(buf,1,bytesRead,bf);}
\DoxyCodeLine{00661           \textcolor{keywordflow}{if} (bytesRead!=bytesWritten)}
\DoxyCodeLine{00662           \{}
\DoxyCodeLine{00663             \textcolor{comment}{// handle error}}
\DoxyCodeLine{00664             \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_aede5746344fdce99647541101eaa7f06}{err}}(\textcolor{stringliteral}{"{}Failed to write to filter database \%s. Wrote \%zu out of \%zu bytes\(\backslash\)n"{}},}
\DoxyCodeLine{00665                 \mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(\mbox{\hyperlink{class_doxygen_a076ed5b2ed20d6f9a7d3a7adc9049f09}{Doxygen::filterDBFileName}}),bytesWritten,bytesRead);}
\DoxyCodeLine{00666             str.\mbox{\hyperlink{class_buf_str_a36ec062edea86b33b794eeab37f32b1c}{addChar}}(\textcolor{charliteral}{'\(\backslash\)0'});}
\DoxyCodeLine{00667             \mbox{\hyperlink{namespace_portable_a6cde8cab8c3dc3397ea5c6030fbf6e84}{Portable::pclose}}(\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}});}
\DoxyCodeLine{00668             \mbox{\hyperlink{namespace_portable_af099fa6239b4961887192d8eadfd2a44}{fclose}}(bf);}
\DoxyCodeLine{00669             \textcolor{keywordflow}{return} \mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}};}
\DoxyCodeLine{00670           \}}
\DoxyCodeLine{00671           \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a1e79fade784ffb450b103ad42e120fa0}{size}}+=bytesWritten;}
\DoxyCodeLine{00672           str.\mbox{\hyperlink{class_buf_str_a1b51ff3c6cd8c69cd32992570ef109d4}{addArray}}(buf,\textcolor{keyword}{static\_cast<}\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a4d3943ddea65db7163a58e6c7e8df95a}{uint}}\textcolor{keyword}{>}(bytesWritten));}
\DoxyCodeLine{00673         \}}
\DoxyCodeLine{00674         str.\mbox{\hyperlink{class_buf_str_a36ec062edea86b33b794eeab37f32b1c}{addChar}}(\textcolor{charliteral}{'\(\backslash\)0'});}
\DoxyCodeLine{00675         item.\mbox{\hyperlink{struct_filter_cache_item_a5e8de0dabe98585d43c628924b331507}{fileSize}} = \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a1e79fade784ffb450b103ad42e120fa0}{size}};}
\DoxyCodeLine{00676         \textcolor{comment}{// add location entry to the dictionary}}
\DoxyCodeLine{00677         \mbox{\hyperlink{class_filter_cache_a0af0e0a5434ae8a1225de2f2a3210078}{m\_cache}}.insert(std::make\_pair(fileName.str(),item));}
\DoxyCodeLine{00678         \mbox{\hyperlink{class_debug_a5d86ffebf96f9f75b6c957db5f831da3}{Debug::print}}(\mbox{\hyperlink{class_debug_a9e0b892a8030a4f64076850777991c96adeaa5931452b9cc0cbfad497d71c093b}{Debug::FilterOutput}},0,\textcolor{stringliteral}{"{}Storing new filter result for \%s in \%s at offset=\%lld size=\%zu\(\backslash\)n"{}},}
\DoxyCodeLine{00679                \mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(fileName),\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(\mbox{\hyperlink{class_doxygen_a076ed5b2ed20d6f9a7d3a7adc9049f09}{Doxygen::filterDBFileName}}),item.\mbox{\hyperlink{struct_filter_cache_item_a299a11b01794a0983f310a3c0681763a}{filePos}},item.\mbox{\hyperlink{struct_filter_cache_item_a5e8de0dabe98585d43c628924b331507}{fileSize}});}
\DoxyCodeLine{00680         \textcolor{comment}{// update end of file position}}
\DoxyCodeLine{00681         \mbox{\hyperlink{class_filter_cache_a5ef8cdbd8e0b997aeeb92777ff5fc965}{m\_endPos}} += \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a1e79fade784ffb450b103ad42e120fa0}{size}};}
\DoxyCodeLine{00682         \mbox{\hyperlink{namespace_portable_a6cde8cab8c3dc3397ea5c6030fbf6e84}{Portable::pclose}}(\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}});}
\DoxyCodeLine{00683         \mbox{\hyperlink{namespace_portable_af099fa6239b4961887192d8eadfd2a44}{fclose}}(bf);}
\DoxyCodeLine{00684       \}}
\DoxyCodeLine{00685       \textcolor{keywordflow}{else} \textcolor{comment}{// no filtering}}
\DoxyCodeLine{00686       \{}
\DoxyCodeLine{00687         \textcolor{comment}{// normal file}}
\DoxyCodeLine{00688         \textcolor{comment}{//printf("{}getFileContents(\%s): no filter\(\backslash\)n"{},qPrint(fileName));}}
\DoxyCodeLine{00689         \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}} = \mbox{\hyperlink{namespace_portable_a4dbb08c3de409bd1a73be3da6d93ac57}{Portable::fopen}}(fileName,\textcolor{stringliteral}{"{}r"{}});}
\DoxyCodeLine{00690         \textcolor{keywordflow}{while} (!feof(\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}}))}
\DoxyCodeLine{00691         \{}
\DoxyCodeLine{00692           \textcolor{keywordtype}{size\_t} bytesRead = fread(buf,1,blockSize,\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}});}
\DoxyCodeLine{00693           str.\mbox{\hyperlink{class_buf_str_a1b51ff3c6cd8c69cd32992570ef109d4}{addArray}}(buf,\textcolor{keyword}{static\_cast<}\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a4d3943ddea65db7163a58e6c7e8df95a}{uint}}\textcolor{keyword}{>}(bytesRead));}
\DoxyCodeLine{00694         \}}
\DoxyCodeLine{00695         str.\mbox{\hyperlink{class_buf_str_a36ec062edea86b33b794eeab37f32b1c}{addChar}}(\textcolor{charliteral}{'\(\backslash\)0'});}
\DoxyCodeLine{00696         \mbox{\hyperlink{namespace_portable_af099fa6239b4961887192d8eadfd2a44}{fclose}}(\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}});}
\DoxyCodeLine{00697       \}}
\DoxyCodeLine{00698       \textcolor{keywordflow}{return} \mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}};}
\DoxyCodeLine{00699     \}}

\end{DoxyCode}


References \mbox{\hyperlink{class_buf_str_a1b51ff3c6cd8c69cd32992570ef109d4}{Buf\+Str\+::add\+Array()}}, \mbox{\hyperlink{class_buf_str_a36ec062edea86b33b794eeab37f32b1c}{Buf\+Str\+::add\+Char()}}, \mbox{\hyperlink{build_2doxygen_2src_2config_8h_a5373d0332a31f16ad7a42037733e8c79}{Config\+\_\+get\+Bool}}, \mbox{\hyperlink{class_buf_str_a38f1315046acdef23cab4dc53c6eda2b}{Buf\+Str\+::data()}}, \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_aede5746344fdce99647541101eaa7f06}{err()}}, \mbox{\hyperlink{class_debug_a9e0b892a8030a4f64076850777991c96ae0f271a190b409433daefa05343c9eee}{Debug\+::\+Ext\+Cmd}}, \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}}, \mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}}, \mbox{\hyperlink{namespace_portable_af099fa6239b4961887192d8eadfd2a44}{Portable\+::fclose()}}, \mbox{\hyperlink{struct_filter_cache_item_a299a11b01794a0983f310a3c0681763a}{Filter\+Cache\+Item\+::file\+Pos}}, \mbox{\hyperlink{struct_filter_cache_item_a5e8de0dabe98585d43c628924b331507}{Filter\+Cache\+Item\+::file\+Size}}, \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_ac48c7cc368d341ab2c1c9ec3fab9c273}{filter}}, \mbox{\hyperlink{class_doxygen_a076ed5b2ed20d6f9a7d3a7adc9049f09}{Doxygen\+::filter\+DBFile\+Name}}, \mbox{\hyperlink{class_debug_a9e0b892a8030a4f64076850777991c96adeaa5931452b9cc0cbfad497d71c093b}{Debug\+::\+Filter\+Output}}, \mbox{\hyperlink{namespace_portable_a4dbb08c3de409bd1a73be3da6d93ac57}{Portable\+::fopen()}}, \mbox{\hyperlink{namespace_portable_a508bfa22b32f24c3920ab65097fd9d59}{Portable\+::fseek()}}, \mbox{\hyperlink{build_2doxygen_2src_2util_8cpp_ad4426e053bb11589c58bd5c6828817e2}{get\+File\+Filter()}}, \mbox{\hyperlink{namespace_portable_a6cde8cab8c3dc3397ea5c6030fbf6e84}{Portable\+::pclose()}}, \mbox{\hyperlink{namespace_portable_a15b92ac03be9e8f4d95d5e881342d83c}{Portable\+::popen()}}, \mbox{\hyperlink{class_debug_a5d86ffebf96f9f75b6c957db5f831da3}{Debug\+::print()}}, \mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{q\+Print()}}, \mbox{\hyperlink{class_buf_str_af4bda58a1b9cbf4f33fe3d247502e1f4}{Buf\+Str\+::resize()}}, \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a1e79fade784ffb450b103ad42e120fa0}{size}}, \mbox{\hyperlink{class_q_c_string_a875e9ad762554ef12f3ed69b015bb245}{QCString\+::str()}}, and \mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}}.



\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{class_filter_cache_a0af0e0a5434ae8a1225de2f2a3210078}\label{class_filter_cache_a0af0e0a5434ae8a1225de2f2a3210078}} 
\index{FilterCache@{FilterCache}!m\_cache@{m\_cache}}
\index{m\_cache@{m\_cache}!FilterCache@{FilterCache}}
\doxysubsubsection{\texorpdfstring{m\_cache}{m\_cache}}
{\footnotesize\ttfamily std\+::unordered\+\_\+map$<$ \mbox{\hyperlink{libmscgen_2gd_8h_a13690c1a2aacb1c8261e3be3c4a4f4b2}{std\+::string}}, \mbox{\hyperlink{struct_filter_cache_item}{Filter\+Cache\+Item}} $>$ Filter\+Cache\+::m\+\_\+cache\hspace{0.3cm}{\ttfamily [private]}}



Definition at line \mbox{\hyperlink{build_2doxygen_2src_2definition_8cpp_source_l00701}{701}} of file \mbox{\hyperlink{build_2doxygen_2src_2definition_8cpp_source}{definition.\+cpp}}.

\mbox{\Hypertarget{class_filter_cache_a5ef8cdbd8e0b997aeeb92777ff5fc965}\label{class_filter_cache_a5ef8cdbd8e0b997aeeb92777ff5fc965}} 
\index{FilterCache@{FilterCache}!m\_endPos@{m\_endPos}}
\index{m\_endPos@{m\_endPos}!FilterCache@{FilterCache}}
\doxysubsubsection{\texorpdfstring{m\_endPos}{m\_endPos}}
{\footnotesize\ttfamily \mbox{\hyperlink{build_2doxygen_2src_2portable_8h_a25423a5b429a3ee0610315d93938bd0b}{portable\+\_\+off\+\_\+t}} Filter\+Cache\+::m\+\_\+end\+Pos\hspace{0.3cm}{\ttfamily [private]}}



Definition at line \mbox{\hyperlink{build_2doxygen_2src_2definition_8cpp_source_l00702}{702}} of file \mbox{\hyperlink{build_2doxygen_2src_2definition_8cpp_source}{definition.\+cpp}}.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
doxygen/build/doxygen/src/\mbox{\hyperlink{build_2doxygen_2src_2definition_8cpp}{definition.\+cpp}}\item 
doxygen/src/\mbox{\hyperlink{src_2definition_8cpp}{definition.\+cpp}}\end{DoxyCompactItemize}
