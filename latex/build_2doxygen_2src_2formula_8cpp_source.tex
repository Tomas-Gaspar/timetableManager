\hypertarget{build_2doxygen_2src_2formula_8cpp_source}{}\doxysection{formula.\+cpp}
\label{build_2doxygen_2src_2formula_8cpp_source}\index{doxygen/build/doxygen/src/formula.cpp@{doxygen/build/doxygen/src/formula.cpp}}
\mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00001}00001 \textcolor{comment}{/******************************************************************************}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00002}00002 \textcolor{comment}{ *}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00003}00003 \textcolor{comment}{ * Copyright (C) 1997-\/2022 by Dimitri van Heesch.}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00004}00004 \textcolor{comment}{ *}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00005}00005 \textcolor{comment}{ * Permission to use, copy, modify, and distribute this software and its}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00006}00006 \textcolor{comment}{ * documentation under the terms of the GNU General Public License is hereby}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00007}00007 \textcolor{comment}{ * granted. No representations are made about the suitability of this software}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00008}00008 \textcolor{comment}{ * for any purpose. It is provided "{}as is"{} without express or implied warranty.}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00009}00009 \textcolor{comment}{ * See the GNU General Public License for more details.}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00010}00010 \textcolor{comment}{ *}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00011}00011 \textcolor{comment}{ * Documents produced by Doxygen are derivative works derived from the}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00012}00012 \textcolor{comment}{ * input used in their production; they are not affected by this license.}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00013}00013 \textcolor{comment}{ *}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00014}00014 \textcolor{comment}{ */}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00015}00015 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00016}00016 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{src_2formula_8h}{formula.h}}"{}}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00017}00017 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{src_2message_8h}{message.h}}"{}}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00018}00018 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{src_2config_8h}{config.h}}"{}}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00019}00019 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{src_2util_8h}{util.h}}"{}}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00020}00020 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{src_2portable_8h}{portable.h}}"{}}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00021}00021 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{src_2image_8h}{image.h}}"{}}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00022}00022 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{src_2fileinfo_8h}{fileinfo.h}}"{}}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00023}00023 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{src_2dir_8h}{dir.h}}"{}}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00024}00024 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{src_2regex_8h}{regex.h}}"{}}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00025}00025 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{src_2linkedmap_8h}{linkedmap.h}}"{}}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00026}00026 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00027}00027 \textcolor{preprocessor}{\#include <map>}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00028}00028 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00029}00029 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00030}00030 \textcolor{preprocessor}{\#include <utility>}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00031}00031 \textcolor{preprocessor}{\#include <fstream>}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00032}00032 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00033}00033 \textcolor{comment}{// TODO: remove these dependencies}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00034}00034 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{src_2doxygen_8h}{doxygen.h}}"{}}   \textcolor{comment}{// for Doxygen::indexList}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00035}00035 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{src_2indexlist_8h}{indexlist.h}}"{}} \textcolor{comment}{// for Doxygen::indexList}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00036}00036 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00037}00037 \textcolor{keyword}{static} \textcolor{keywordtype}{int} \mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_a1882de11e1ccd91da1167ed471d1add5}{determineInkscapeVersion}}(\mbox{\hyperlink{class_dir}{Dir}} \&thisDir);}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00038}00038 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00039}00039 \textcolor{comment}{// Remove the temporary files}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00040}\mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_a6e85eab155453f359a60e118e7e64fba}{00040}} \textcolor{preprocessor}{\#define RM\_TMP\_FILES (true)}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00041}00041 \textcolor{comment}{//\#define RM\_TMP\_FILES (false)}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00042}00042 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00043}\mbox{\hyperlink{struct_formula_manager_1_1_private}{00043}} \textcolor{keyword}{struct }\mbox{\hyperlink{struct_formula_manager_1_1_private}{FormulaManager::Private}}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00044}00044 \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00045}\mbox{\hyperlink{struct_formula_manager_1_1_private_a631de1f2a4b460464714d99f8750f50f}{00045}}   \mbox{\hyperlink{class_linked_map}{LinkedMap<Formula>}}      \mbox{\hyperlink{struct_formula_manager_1_1_private_a631de1f2a4b460464714d99f8750f50f}{formulas}};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00046}\mbox{\hyperlink{struct_formula_manager_1_1_private_a687684f561539c94346d8bf926ed575a}{00046}}   std::map<int,Formula *> \mbox{\hyperlink{struct_formula_manager_1_1_private_a687684f561539c94346d8bf926ed575a}{formulaIdMap}};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00047}\mbox{\hyperlink{struct_formula_manager_1_1_private_a0c22106da2adbdc4ebcc5237f51e95ce}{00047}}   \textcolor{keywordtype}{bool}                    \mbox{\hyperlink{struct_formula_manager_1_1_private_a0c22106da2adbdc4ebcc5237f51e95ce}{repositoriesValid}} = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00048}\mbox{\hyperlink{struct_formula_manager_1_1_private_a9f9ca400f79ee303624f850efe0d490c}{00048}}   \mbox{\hyperlink{build_2doxygen_2src_2containers_8h_ac8d53003529fb2d062d614077fe6857c}{StringVector}}            \mbox{\hyperlink{struct_formula_manager_1_1_private_a9f9ca400f79ee303624f850efe0d490c}{tempFiles}};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00049}00049 \};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00050}00050 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00051}\mbox{\hyperlink{class_formula_manager_a13fd2eedbb1c7f086bd66cbd6e049911}{00051}} \mbox{\hyperlink{class_formula_manager_a13fd2eedbb1c7f086bd66cbd6e049911}{FormulaManager::FormulaManager}}() : \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_ab5a2e47807ddbc8459ae782c1274e78b}{p}}(std::make\_unique<\mbox{\hyperlink{struct_formula_manager_1_1_private}{Private}}>())}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00052}00052 \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00053}00053 \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00054}00054 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00055}\mbox{\hyperlink{class_formula_manager_ab5c33a247a1b081414e3350552beb6ee}{00055}} \mbox{\hyperlink{class_formula_manager}{FormulaManager}} \&\mbox{\hyperlink{class_formula_manager_ab5c33a247a1b081414e3350552beb6ee}{FormulaManager::instance}}()}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00056}00056 \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00057}00057   \textcolor{keyword}{static} \mbox{\hyperlink{class_formula_manager}{FormulaManager}} fm;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00058}00058   \textcolor{keywordflow}{return} fm;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00059}00059 \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00060}00060 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00061}\mbox{\hyperlink{class_formula_manager_a10998c967b5e151acf3dad299deb0bc9}{00061}} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_formula_manager_a10998c967b5e151acf3dad299deb0bc9}{FormulaManager::initFromRepository}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_q_c_string}{QCString}} \&dir)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00062}00062 \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00063}00063   \mbox{\hyperlink{namespaceghc_1_1filesystem_ac5ce4cc34ef910b06b64f6110c866e2e}{std::ifstream}} \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}}(dir.\mbox{\hyperlink{class_q_c_string_a875e9ad762554ef12f3ed69b015bb245}{str}}()+\textcolor{stringliteral}{"{}/formula.repository"{}},std::ifstream::in);}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00064}00064   \textcolor{keywordflow}{if} (\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}}.is\_open())}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00065}00065   \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00066}00066     \mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a4d3943ddea65db7163a58e6c7e8df95a}{uint}} formulaCount=0;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00067}00067     \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_aba549a028419cd48a3f373037c2c57eb}{msg}}(\textcolor{stringliteral}{"{}Reading formula repository...\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00068}00068     \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_ab316628fa3d58332c1756353c49316c1}{std::string}} readLine;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00069}00069     \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_ab316628fa3d58332c1756353c49316c1}{std::string}} line;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00070}00070     \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_ab316628fa3d58332c1756353c49316c1}{std::string}} prefix(\textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)\_form\#"{}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00071}00071     \textcolor{keywordtype}{int} lineNr;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00072}00072     \textcolor{keywordtype}{int} nextLineNr=1;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00073}00073     \textcolor{keywordtype}{bool} hasNextLine = !getline(\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}},readLine).fail();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00074}00074     \textcolor{keywordflow}{while} (hasNextLine)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00075}00075     \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00076}00076       line = readLine;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00077}00077       lineNr = nextLineNr;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00078}00078 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00079}00079       \textcolor{comment}{// look ahead a bit because a formula can be spread over several lines}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00080}00080       \textcolor{keywordflow}{while} ((hasNextLine = !getline(\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}},readLine).fail()))}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00081}00081       \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00082}00082         nextLineNr+=1;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00083}00083         \textcolor{keywordflow}{if} (!readLine.compare(0, prefix.size(), prefix)) \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00084}00084         line += \textcolor{stringliteral}{"{}\(\backslash\)n"{}} + readLine;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00085}00085       \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00086}00086 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00087}00087       \textcolor{comment}{// new format: \(\backslash\)\_form\#<digits>=<digits>x<digits>:formula}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00088}00088       \textcolor{keyword}{static} \textcolor{keyword}{const} \mbox{\hyperlink{classreg_1_1_ex}{reg::Ex}} re\_new(R\textcolor{stringliteral}{"{}(\(\backslash\)\(\backslash\)\_form\#(\(\backslash\)d+)=(\(\backslash\)d+)x(\(\backslash\)d+):)"{});}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00089}00089 \textcolor{stringliteral}{      }\textcolor{comment}{// old format: \(\backslash\)\_form\#<digits>:formula}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00090}00090       \textcolor{keyword}{static} \textcolor{keyword}{const} \mbox{\hyperlink{classreg_1_1_ex}{reg::Ex}} re\_old(R\textcolor{stringliteral}{"{}(\(\backslash\)\(\backslash\)\_form\#(\(\backslash\)d+):)"{});}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00091}00091 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00092}00092 \textcolor{stringliteral}{      \mbox{\hyperlink{classreg_1_1_match}{reg::Match}} \mbox{\hyperlink{namespacereg_a1a29dcc7e2ccf462503adc5d496881ae}{match}};}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00093}00093 \textcolor{stringliteral}{      }\textcolor{keywordtype}{int} \textcolor{keywordtype}{id}     = -\/1;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00094}00094       \textcolor{keywordtype}{int} width  = -\/1;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00095}00095       \textcolor{keywordtype}{int} height = -\/1;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00096}00096       \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_ab316628fa3d58332c1756353c49316c1}{std::string}} text;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00097}00097       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacereg_a66de3a25d4b9ff13d33f4d3e416fb948}{reg::search}}(line,\mbox{\hyperlink{namespacereg_a1a29dcc7e2ccf462503adc5d496881ae}{match}},re\_new)) \textcolor{comment}{// try new format first}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00098}00098       \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00099}00099         \textcolor{keywordtype}{id}     = std::stoi(\mbox{\hyperlink{namespacereg_a1a29dcc7e2ccf462503adc5d496881ae}{match}}[1].str());}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00100}00100         width  = std::stoi(\mbox{\hyperlink{namespacereg_a1a29dcc7e2ccf462503adc5d496881ae}{match}}[2].str());}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00101}00101         height = std::stoi(\mbox{\hyperlink{namespacereg_a1a29dcc7e2ccf462503adc5d496881ae}{match}}[3].str());}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00102}00102         text   = line.substr(\mbox{\hyperlink{namespacereg_a1a29dcc7e2ccf462503adc5d496881ae}{match}}.position()+\mbox{\hyperlink{namespacereg_a1a29dcc7e2ccf462503adc5d496881ae}{match}}.length());}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00103}00103         \textcolor{comment}{//printf("{}new format found id=\%d width=\%d height=\%d text=\%s\(\backslash\)n"{},id,width,height,text.c\_str());}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00104}00104       \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00105}00105       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacereg_a66de3a25d4b9ff13d33f4d3e416fb948}{reg::search}}(line,\mbox{\hyperlink{namespacereg_a1a29dcc7e2ccf462503adc5d496881ae}{match}},re\_old)) \textcolor{comment}{// check for old format}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00106}00106       \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00107}00107         \textcolor{comment}{//id     = std::stoi(match[1].str());}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00108}00108         \textcolor{comment}{//text   = line.substr(match.position()+match.length());}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00109}00109         \textcolor{comment}{//printf("{}old format found id=\%d text=\%s\(\backslash\)n"{},id,text.c\_str());}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00110}00110         \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_aba549a028419cd48a3f373037c2c57eb}{msg}}(\textcolor{stringliteral}{"{}old formula.repository format detected; forcing upgrade.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00111}00111         \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>repositoriesValid = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00112}00112         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00113}00113       \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00114}00114       \textcolor{keywordflow}{else} \textcolor{comment}{// unexpected content}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00115}00115       \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00116}00116         \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_a1fd98c6976d3826490804976e17eb83f}{warn\_uncond}}(\textcolor{stringliteral}{"{}\%s/formula.repository contains invalid content at line \%d: found: '\%s'\(\backslash\)n"{}},\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(dir),lineNr,line.c\_str());}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00117}00117         \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>repositoriesValid = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00118}00118         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00119}00119       \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00120}00120 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00121}00121       \textcolor{keyword}{auto} it = \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>formulaIdMap.find(\textcolor{keywordtype}{id});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00122}00122       \mbox{\hyperlink{class_formula}{Formula}} *formula=0;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00123}00123       \textcolor{keywordflow}{if} (it!=\mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>formulaIdMap.end()) \textcolor{comment}{// formula already found in a repository for another output format}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00124}00124       \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00125}00125         formula = it-\/>second;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00126}00126         \textcolor{keywordflow}{if} (formula-\/>\mbox{\hyperlink{class_formula_a67b9ebbbe7e4814eb09bbf734af69b0e}{text}}().\mbox{\hyperlink{class_q_c_string_a875e9ad762554ef12f3ed69b015bb245}{str}}()!=text) \textcolor{comment}{// inconsistency between repositories detected}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00127}00127         \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00128}00128           \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_aba549a028419cd48a3f373037c2c57eb}{msg}}(\textcolor{stringliteral}{"{}differences detected between formula.repository files; forcing upgrade.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00129}00129           \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>repositoriesValid = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00130}00130           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00131}00131         \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00132}00132         formulaCount++;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00133}00133       \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00134}00134       \textcolor{keywordflow}{else} \textcolor{comment}{// create new formula from cache}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00135}00135       \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00136}00136         \textcolor{comment}{//printf("{}formula not found adding it under id=\%d\(\backslash\)n"{},id);}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00137}00137         formula = \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>formulas.add(text.c\_str(),\textcolor{keywordtype}{id},width,height);}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00138}00138         \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>formulaIdMap.insert(std::make\_pair(\textcolor{keywordtype}{id},formula));}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00139}00139       \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00140}00140 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00141}00141       \textcolor{keywordflow}{if} (formula) \textcolor{comment}{// if an entry in the repository exists also check if there is a generated image}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00142}00142       \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00143}00143         \mbox{\hyperlink{class_q_c_string}{QCString}} formImgName;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00144}00144         formImgName.\mbox{\hyperlink{class_q_c_string_aa2dccf89cb25346c3ee81d75aa5859da}{sprintf}}(\textcolor{stringliteral}{"{}form\_\%d"{}},formula-\/>\mbox{\hyperlink{class_formula_ae4b7648ae0124da8456fa2c8e51991ba}{id}}());}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00145}00145         \mbox{\hyperlink{class_file_info}{FileInfo}} fiPng((dir+\textcolor{stringliteral}{"{}/"{}}+formImgName+\textcolor{stringliteral}{"{}.png"{}}).str());}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00146}00146         \mbox{\hyperlink{class_file_info}{FileInfo}} fiSvg((dir+\textcolor{stringliteral}{"{}/"{}}+formImgName+\textcolor{stringliteral}{"{}.svg"{}}).str());}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00147}00147         \textcolor{comment}{// mark formula as cached, so we do not need to regenerate the images}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00148}00148         \textcolor{keywordtype}{bool} isCached = fiPng.\mbox{\hyperlink{class_file_info_a47d49db8cb8797153885c4d5b7b0911f}{exists}}() || fiSvg.\mbox{\hyperlink{class_file_info_a47d49db8cb8797153885c4d5b7b0911f}{exists}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00149}00149         formula-\/>\mbox{\hyperlink{class_formula_ab1e3947577b724a83ee9f51124abc71e}{setCached}}(isCached);}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00150}00150         \textcolor{comment}{//printf("{}formula \%d: cached=\%d\(\backslash\)n"{},formula-\/>id(),isCached);}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00151}00151 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00152}00152         \mbox{\hyperlink{class_file_info}{FileInfo}} fiPngDark((dir+\textcolor{stringliteral}{"{}/"{}}+formImgName+\textcolor{stringliteral}{"{}\_dark.png"{}}).str());}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00153}00153         \mbox{\hyperlink{class_file_info}{FileInfo}} fiSvgDark((dir+\textcolor{stringliteral}{"{}/"{}}+formImgName+\textcolor{stringliteral}{"{}\_dark.svg"{}}).str());}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00154}00154         \textcolor{keywordtype}{bool} isCachedDark = fiPngDark.\mbox{\hyperlink{class_file_info_a47d49db8cb8797153885c4d5b7b0911f}{exists}}() || fiSvgDark.\mbox{\hyperlink{class_file_info_a47d49db8cb8797153885c4d5b7b0911f}{exists}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00155}00155         formula-\/>\mbox{\hyperlink{class_formula_a3a025efe9a3c4850b11efd9f5905213e}{setCachedDark}}(isCachedDark);}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00156}00156         \textcolor{comment}{//printf("{}formula \%d: cachedDark=\%d\(\backslash\)n"{},formula-\/>id(),isCachedDark);}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00157}00157       \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00158}00158     \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00159}00159 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00160}00160     \textcolor{comment}{// For the first repository all formulas should be new (e.g. formulaCount==0).}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00161}00161     \textcolor{comment}{// For the other repositories the same number of formulas should be found}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00162}00162     \textcolor{comment}{// (and number of formulas should be the same for all repositories, content is already check above)}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00163}00163     \textcolor{keywordflow}{if} (formulaCount>0 \&\& formulaCount!=\mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>formulas.size()) \textcolor{comment}{// inconsistency between repositories}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00164}00164     \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00165}00165       \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_aba549a028419cd48a3f373037c2c57eb}{msg}}(\textcolor{stringliteral}{"{}differences detected between formula.repository files; forcing upgrade.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00166}00166       \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>repositoriesValid = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00167}00167     \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00168}00168   \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00169}00169   \textcolor{keywordflow}{else} \textcolor{comment}{// no repository found for an output format}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00170}00170   \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00171}00171     \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>repositoriesValid = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00172}00172   \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00173}00173 \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00174}00174 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00175}\mbox{\hyperlink{class_formula_manager_a9ff2d153c001e2b9d9b054200d34c6a2}{00175}} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_formula_manager_a9ff2d153c001e2b9d9b054200d34c6a2}{FormulaManager::checkRepositories}}()}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00176}00176 \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00177}00177   \textcolor{comment}{//printf("{}checkRepositories valid=\%d\(\backslash\)n"{},p-\/>repositoriesValid);}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00178}00178   \textcolor{keywordflow}{if} (!\mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>repositoriesValid)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00179}00179   \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00180}00180     \mbox{\hyperlink{class_formula_manager_a5a181349991e3e72a331b231c9c25f8b}{clear}}(); \textcolor{comment}{// clear cached formulas, so the corresponding images and repository files}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00181}00181              \textcolor{comment}{// are regenerated}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00182}00182     \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>repositoriesValid = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00183}00183   \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00184}00184 \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00185}00185 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00186}\mbox{\hyperlink{class_formula_manager_a0f96928dbcf6279d70d38ee11b35ea55}{00186}} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_formula_manager_a0f96928dbcf6279d70d38ee11b35ea55}{FormulaManager::createLatexFile}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_q_c_string}{QCString}} \&fileName,\mbox{\hyperlink{class_formula_manager_aa538ca4ffea4dd937920ebdd41222e69}{Format}} format,\mbox{\hyperlink{class_formula_manager_a417a154a8ce0abdc51353d4475005419}{Mode}} \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_adfd79db267a2c3b3684968e06c3b9155}{mode}},\mbox{\hyperlink{build_2doxygen_2src_2containers_8h_a0b244579717fb04b2fb4ac89ee2f0f35}{IntVector}} \&formulasToGenerate)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00187}00187 \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00188}00188   \mbox{\hyperlink{class_q_c_string}{QCString}} macroFile = \mbox{\hyperlink{build_2doxygen_2src_2config_8h_a737741e6991bdb5694a50075437a9d89}{Config\_getString}}(FORMULA\_MACROFILE);}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00189}00189   \mbox{\hyperlink{class_q_c_string}{QCString}} stripMacroFile;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00190}00190   \textcolor{keywordflow}{if} (!macroFile.\mbox{\hyperlink{class_q_c_string_a621c4090d69ad7d05ef8e5234376c3d8}{isEmpty}}())}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00191}00191   \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00192}00192     \mbox{\hyperlink{class_file_info}{FileInfo}} fi(macroFile.\mbox{\hyperlink{class_q_c_string_a875e9ad762554ef12f3ed69b015bb245}{str}}());}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00193}00193     macroFile=fi.\mbox{\hyperlink{class_file_info_af69e3949475014dcdbd504d742bdf270}{absFilePath}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00194}00194     stripMacroFile = fi.\mbox{\hyperlink{class_file_info_a8ae2069796787d27306bb49bd70e3e3a}{fileName}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00195}00195   \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00196}00196 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00197}00197   \textcolor{comment}{// generate a latex file containing one formula per page.}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00198}00198   \mbox{\hyperlink{class_q_c_string}{QCString}} texName=fileName+\textcolor{stringliteral}{"{}.tex"{}};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00199}00199   \mbox{\hyperlink{namespaceghc_1_1filesystem_a5a9df37f9ba2cf3b2dabb4a221b71b09}{std::ofstream}} \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}}(texName.\mbox{\hyperlink{class_q_c_string_a875e9ad762554ef12f3ed69b015bb245}{str}}(),\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a48bc11919b2752df9d14ce89557cfb25}{std::ofstream::out}} | std::ofstream::binary);}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00200}00200   \textcolor{keywordflow}{if} (\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}}.is\_open())}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00201}00201   \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00202}00202     \mbox{\hyperlink{class_text_stream}{TextStream}} t(\&\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00203}00203     t << \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)documentclass\{article\}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00204}00204     t << \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)usepackage\{ifthen\}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00205}00205     t << \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)usepackage\{epsfig\}\(\backslash\)n"{}}; \textcolor{comment}{// for those who want to include images}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00206}00206     t << \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)usepackage[utf8]\{inputenc\}\(\backslash\)n"{}}; \textcolor{comment}{// looks like some older distributions with newunicode package 1.1 need this option.}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00207}00207     t << \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)usepackage\{xcolor\}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00208}00208 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00209}00209     \textcolor{keywordflow}{if} (\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_adfd79db267a2c3b3684968e06c3b9155}{mode}}==\mbox{\hyperlink{class_formula_manager_a417a154a8ce0abdc51353d4475005419aa18366b217ebf811ad1886e4f4f865b2}{Mode::Dark}}) \textcolor{comment}{// invert page and text colors}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00210}00210     \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00211}00211       t << \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)color\{white\}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00212}00212       t << \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)pagecolor\{black\}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00213}00213     \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00214}00214 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00215}00215     \mbox{\hyperlink{build_2doxygen_2src_2util_8cpp_ace2411e2a91d0794515d7319a05a96e4}{writeExtraLatexPackages}}(t);}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00216}00216     \mbox{\hyperlink{build_2doxygen_2src_2util_8cpp_afb096be4b2c37adc54becb763cc99470}{writeLatexSpecialFormulaChars}}(t);}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00217}00217     \textcolor{keywordflow}{if} (!macroFile.\mbox{\hyperlink{class_q_c_string_a621c4090d69ad7d05ef8e5234376c3d8}{isEmpty}}())}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00218}00218     \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00219}00219       \mbox{\hyperlink{build_2doxygen_2src_2util_8cpp_ad35d4038b3882fdd09976d28f4a043bf}{copyFile}}(macroFile,stripMacroFile);}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00220}00220       t << \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)input\{"{}} << stripMacroFile << \textcolor{stringliteral}{"{}\}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00221}00221     \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00222}00222     t << \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)pagestyle\{empty\}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00223}00223     t << \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)begin\{document\}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00224}00224     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&formula : \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>formulas)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00225}00225     \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00226}00226       \textcolor{keywordtype}{int} \textcolor{keywordtype}{id} = formula-\/>id();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00227}00227       \textcolor{comment}{// only formulas for which no image is cached are generated}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00228}00228       \textcolor{comment}{//printf("{}check formula \%d: cached=\%d cachedDark=\%d\(\backslash\)n"{},formula-\/>id(),formula-\/>isCached(),formula-\/>isCachedDark());}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00229}00229       \textcolor{keywordflow}{if} ((\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_adfd79db267a2c3b3684968e06c3b9155}{mode}}==\mbox{\hyperlink{class_formula_manager_a417a154a8ce0abdc51353d4475005419a9914a0ce04a7b7b6a8e39bec55064b82}{Mode::Light}} \&\& !formula-\/>isCached()) ||}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00230}00230           (\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_adfd79db267a2c3b3684968e06c3b9155}{mode}}==\mbox{\hyperlink{class_formula_manager_a417a154a8ce0abdc51353d4475005419aa18366b217ebf811ad1886e4f4f865b2}{Mode::Dark}} \&\& !formula-\/>isCachedDark())}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00231}00231          )}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00232}00232       \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00233}00233         \textcolor{comment}{// we force a pagebreak after each formula}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00234}00234         t << formula-\/>text() << \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)\(\backslash\)pagebreak\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00235}00235         formulasToGenerate.push\_back(\textcolor{keywordtype}{id});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00236}00236       \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00237}00237       \mbox{\hyperlink{class_q_c_string}{QCString}} resultName;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00238}00238       resultName.\mbox{\hyperlink{class_q_c_string_aa2dccf89cb25346c3ee81d75aa5859da}{sprintf}}(\textcolor{stringliteral}{"{}form\_\%d\%s.\%s"{}},\textcolor{keywordtype}{id}, \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_adfd79db267a2c3b3684968e06c3b9155}{mode}}==\mbox{\hyperlink{class_formula_manager_a417a154a8ce0abdc51353d4475005419a9914a0ce04a7b7b6a8e39bec55064b82}{Mode::Light}}?\textcolor{stringliteral}{"{}"{}}:\textcolor{stringliteral}{"{}\_dark"{}}, format==\mbox{\hyperlink{class_formula_manager_aa538ca4ffea4dd937920ebdd41222e69a57dea6f5039281b7fee517fc43bf3110}{Format::Vector}}?\textcolor{stringliteral}{"{}svg"{}}:\textcolor{stringliteral}{"{}png"{}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00239}00239       \mbox{\hyperlink{class_doxygen_a52fd39c003e72f197e3ee164cbf2ff82}{Doxygen::indexList}}-\/>\mbox{\hyperlink{class_index_list_aac3c1b70be363f488269cd9054cc7621}{addImageFile}}(resultName);}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00240}00240     \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00241}00241     t << \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)end\{document\}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00242}00242     t.\mbox{\hyperlink{class_text_stream_a907937b613a56aa4124608b3a092b820}{flush}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00243}00243     \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}}.close();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00244}00244   \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00245}00245 \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00246}00246 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00247}\mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_a704ccf2352fafe16ddf093abbaa6f7b4}{00247}} \textcolor{keyword}{static} \textcolor{keywordtype}{bool} \mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_a704ccf2352fafe16ddf093abbaa6f7b4}{createDVIFile}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_q_c_string}{QCString}} \&fileName)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00248}00248 \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00249}00249   \mbox{\hyperlink{class_q_c_string}{QCString}} latexCmd = \textcolor{stringliteral}{"{}latex"{}};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00250}00250   \textcolor{keywordtype}{char} args[4096];}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00251}00251   \mbox{\hyperlink{namespace_portable_ada9653ce1cfc72cc4923aac726435962}{Portable::sysTimerStart}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00252}00252   \textcolor{keywordtype}{int} rerunCount=1;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00253}00253   \textcolor{keywordflow}{while} (rerunCount<8)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00254}00254   \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00255}00255     \textcolor{comment}{//printf("{}Running latex...\(\backslash\)n"{});}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00256}00256     sprintf(args,\textcolor{stringliteral}{"{}-\/interaction=batchmode \%s >\%s"{}},\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(fileName),\mbox{\hyperlink{namespace_portable_aec45ff95f54eed28050e42d3638907cf}{Portable::devNull}}());}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00257}00257     \textcolor{keywordflow}{if} ((\mbox{\hyperlink{namespace_portable_ab30a636186b72a67d57e9f7f1e917e99}{Portable::system}}(latexCmd,args)!=0) || (\mbox{\hyperlink{namespace_portable_ab30a636186b72a67d57e9f7f1e917e99}{Portable::system}}(latexCmd,args)!=0))}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00258}00258     \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00259}00259       \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_aede5746344fdce99647541101eaa7f06}{err}}(\textcolor{stringliteral}{"{}Problems running latex. Check your installation or look "{}}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00260}00260           \textcolor{stringliteral}{"{}for typos in \%s.tex and check \%s.log!\(\backslash\)n"{}},\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(fileName),\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(fileName));}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00261}00261       \mbox{\hyperlink{namespace_portable_a3131c9d07ca7ce1ad22542ce9e417068}{Portable::sysTimerStop}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00262}00262       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00263}00263     \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00264}00264     \textcolor{comment}{// check the log file if we need to run latex again to resolve references}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00265}00265     \mbox{\hyperlink{class_q_c_string}{QCString}} logFile = \mbox{\hyperlink{addon_2doxysearch_2doxyindexer_8cpp_a3aeabebeacfe1261741df6083720583f}{fileToString}}(fileName+\textcolor{stringliteral}{"{}.log"{}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00266}00266     \textcolor{keywordflow}{if} (logFile.\mbox{\hyperlink{class_q_c_string_a621c4090d69ad7d05ef8e5234376c3d8}{isEmpty}}() ||}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00267}00267         (logFile.\mbox{\hyperlink{class_q_c_string_a0182ece6b76dad6475dafb53e2faaf10}{find}}(\textcolor{stringliteral}{"{}Rerun to get cross-\/references right"{}})==-\/1 \&\& logFile.\mbox{\hyperlink{class_q_c_string_a0182ece6b76dad6475dafb53e2faaf10}{find}}(\textcolor{stringliteral}{"{}Rerun LaTeX"{}})==-\/1))}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00268}00268     \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00269}00269       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00270}00270     \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00271}00271     rerunCount++;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00272}00272   \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00273}00273   \mbox{\hyperlink{namespace_portable_a3131c9d07ca7ce1ad22542ce9e417068}{Portable::sysTimerStop}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00274}00274   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00275}00275 \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00276}00276 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00277}\mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_a57b6802045cb92594d1f65e5b8821456}{00277}} \textcolor{keyword}{static} \textcolor{keywordtype}{bool} \mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_a57b6802045cb92594d1f65e5b8821456}{createPostscriptFile}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_q_c_string}{QCString}} \&fileName,\textcolor{keyword}{const} \mbox{\hyperlink{class_q_c_string}{QCString}} \&formBase,\textcolor{keywordtype}{int} pageIndex)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00278}00278 \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00279}00279   \textcolor{keywordtype}{char} args[4096];}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00280}00280   \textcolor{comment}{// run dvips to convert the page with number pageIndex to an}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00281}00281   \textcolor{comment}{// postscript file.}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00282}00282   sprintf(args,\textcolor{stringliteral}{"{}-\/q -\/D 600 -\/n 1 -\/p \%d -\/o \%s\_tmp.ps \%s.dvi"{}},pageIndex,\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(formBase),\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(fileName));}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00283}00283   \mbox{\hyperlink{namespace_portable_ada9653ce1cfc72cc4923aac726435962}{Portable::sysTimerStart}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00284}00284   \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespace_portable_ab30a636186b72a67d57e9f7f1e917e99}{Portable::system}}(\textcolor{stringliteral}{"{}dvips"{}},args)!=0)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00285}00285   \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00286}00286     \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_aede5746344fdce99647541101eaa7f06}{err}}(\textcolor{stringliteral}{"{}Problems running dvips. Check your installation!\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00287}00287     \mbox{\hyperlink{namespace_portable_a3131c9d07ca7ce1ad22542ce9e417068}{Portable::sysTimerStop}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00288}00288     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00289}00289   \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00290}00290   \mbox{\hyperlink{namespace_portable_a3131c9d07ca7ce1ad22542ce9e417068}{Portable::sysTimerStop}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00291}00291   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00292}00292 \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00293}00293 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00294}\mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_a92954fc40f0e05879c1726f8d8207b1f}{00294}} \textcolor{keyword}{static} \textcolor{keywordtype}{bool} \mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_a92954fc40f0e05879c1726f8d8207b1f}{createEPSbboxFile}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_q_c_string}{QCString}} \&formBase)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00295}00295 \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00296}00296   \textcolor{keywordtype}{char} args[4096];}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00297}00297   \textcolor{comment}{// extract the bounding box for the postscript file}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00298}00298   sprintf(args,\textcolor{stringliteral}{"{}-\/q -\/dBATCH -\/dNOPAUSE -\/P-\/ -\/dNOSAFER -\/sDEVICE=bbox \%s\_tmp.ps 2>\%s\_tmp.epsi"{}},}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00299}00299       \mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(formBase),\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(formBase));}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00300}00300   \mbox{\hyperlink{namespace_portable_ada9653ce1cfc72cc4923aac726435962}{Portable::sysTimerStart}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00301}00301   \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespace_portable_ab30a636186b72a67d57e9f7f1e917e99}{Portable::system}}(\mbox{\hyperlink{namespace_portable_a4c4c43977edb27e33f873fbacf11d528}{Portable::ghostScriptCommand}}(),args)!=0)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00302}00302   \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00303}00303     \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_aede5746344fdce99647541101eaa7f06}{err}}(\textcolor{stringliteral}{"{}Problems running \%s. Check your installation!\(\backslash\)n"{}},\mbox{\hyperlink{namespace_portable_a4c4c43977edb27e33f873fbacf11d528}{Portable::ghostScriptCommand}}());}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00304}00304     \mbox{\hyperlink{namespace_portable_a3131c9d07ca7ce1ad22542ce9e417068}{Portable::sysTimerStop}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00305}00305     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00306}00306   \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00307}00307   \mbox{\hyperlink{namespace_portable_a3131c9d07ca7ce1ad22542ce9e417068}{Portable::sysTimerStop}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00308}00308   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00309}00309 \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00310}00310 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00311}\mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_ac7978878c5e2989e9739423aa06f805a}{00311}} \textcolor{keyword}{static} \textcolor{keywordtype}{bool} \mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_ac7978878c5e2989e9739423aa06f805a}{extractBoundingBox}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_q_c_string}{QCString}} \&formBase,}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00312}00312             \textcolor{keywordtype}{int} *\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a97fcb0e1731b36905e90757f211b1340}{x1}},\textcolor{keywordtype}{int} *\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a460698fb30c144b9b1a9508012ef1e43}{y1}},\textcolor{keywordtype}{int} *\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_acf9f5399062fd8bf1dde083f15dcd1fc}{x2}},\textcolor{keywordtype}{int} *\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_aa7986c9249de185e59245a0f83431db9}{y2}},}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00313}00313             \textcolor{keywordtype}{double} *x1hi,\textcolor{keywordtype}{double} *y1hi,\textcolor{keywordtype}{double} *x2hi,\textcolor{keywordtype}{double} *y2hi)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00314}00314 \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00315}00315   \mbox{\hyperlink{class_file_info}{FileInfo}} fi((formBase+\textcolor{stringliteral}{"{}\_tmp.epsi"{}}).str());}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00316}00316   \textcolor{keywordflow}{if} (fi.\mbox{\hyperlink{class_file_info_a47d49db8cb8797153885c4d5b7b0911f}{exists}}())}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00317}00317   \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00318}00318     \mbox{\hyperlink{class_q_c_string}{QCString}} eps = \mbox{\hyperlink{addon_2doxysearch_2doxyindexer_8cpp_a3aeabebeacfe1261741df6083720583f}{fileToString}}(formBase+\textcolor{stringliteral}{"{}\_tmp.epsi"{}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00319}00319     \textcolor{keywordtype}{int} i = eps.\mbox{\hyperlink{class_q_c_string_a0182ece6b76dad6475dafb53e2faaf10}{find}}(\textcolor{stringliteral}{"{}\%\%BoundingBox:"{}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00320}00320     \textcolor{keywordflow}{if} (i!=-\/1)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00321}00321     \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00322}00322       sscanf(eps.\mbox{\hyperlink{class_q_c_string_ac3aa3ac1a1c36d3305eba22a2eb0d098}{data}}()+i,\textcolor{stringliteral}{"{}\%\%\%\%BoundingBox:\%d \%d \%d \%d"{}},\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a97fcb0e1731b36905e90757f211b1340}{x1}},\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a460698fb30c144b9b1a9508012ef1e43}{y1}},\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_acf9f5399062fd8bf1dde083f15dcd1fc}{x2}},\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_aa7986c9249de185e59245a0f83431db9}{y2}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00323}00323     \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00324}00324     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00325}00325     \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00326}00326       \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_aede5746344fdce99647541101eaa7f06}{err}}(\textcolor{stringliteral}{"{}Couldn't extract bounding box from \%s\_tmp.epsi"{}},\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(formBase));}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00327}00327       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00328}00328     \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00329}00329     i = eps.\mbox{\hyperlink{class_q_c_string_a0182ece6b76dad6475dafb53e2faaf10}{find}}(\textcolor{stringliteral}{"{}\%\%HiResBoundingBox:"{}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00330}00330     \textcolor{keywordflow}{if} (i!=-\/1)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00331}00331     \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00332}00332       sscanf(eps.\mbox{\hyperlink{class_q_c_string_ac3aa3ac1a1c36d3305eba22a2eb0d098}{data}}()+i,\textcolor{stringliteral}{"{}\%\%\%\%HiResBoundingBox:\%lf \%lf \%lf \%lf"{}},x1hi,y1hi,x2hi,y2hi);}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00333}00333     \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00334}00334     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00335}00335     \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00336}00336       \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_aede5746344fdce99647541101eaa7f06}{err}}(\textcolor{stringliteral}{"{}Couldn't extract high resolution bounding box from \%s\_tmp.epsi"{}},\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(formBase));}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00337}00337       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00338}00338     \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00339}00339   \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00340}00340   \textcolor{comment}{//printf("{}Bounding box [\%d \%d \%d \%d]\(\backslash\)n"{},x1,y1,x2,y2);}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00341}00341   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00342}00342 \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00343}00343 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00344}\mbox{\hyperlink{class_formula_manager_a70aa26f8a815b1f65663e06a2af49bb7}{00344}} \textcolor{keywordtype}{double} \mbox{\hyperlink{class_formula_manager_a70aa26f8a815b1f65663e06a2af49bb7}{FormulaManager::updateFormulaSize}}(\textcolor{keywordtype}{int} pageNum,\textcolor{keywordtype}{int} \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a97fcb0e1731b36905e90757f211b1340}{x1}},\textcolor{keywordtype}{int} \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a460698fb30c144b9b1a9508012ef1e43}{y1}},\textcolor{keywordtype}{int} \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_acf9f5399062fd8bf1dde083f15dcd1fc}{x2}},\textcolor{keywordtype}{int} \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_aa7986c9249de185e59245a0f83431db9}{y2}})}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00345}00345 \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00346}00346   \textcolor{keywordtype}{double} scaleFactor = 1.25;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00347}00347   \textcolor{keywordtype}{int} zoomFactor = \mbox{\hyperlink{build_2doxygen_2src_2config_8h_a06b59c3720174e9078f613095a89b295}{Config\_getInt}}(FORMULA\_FONTSIZE);}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00348}00348   \textcolor{keywordflow}{if} (zoomFactor<8 || zoomFactor>50) zoomFactor=10;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00349}00349   scaleFactor *= zoomFactor/10.0;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00350}00350 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00351}00351   \textcolor{keyword}{auto} it = \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>formulaIdMap.find(pageNum);}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00352}00352   \textcolor{keywordflow}{if} (it!=\mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>formulaIdMap.end())}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00353}00353   \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00354}00354     \mbox{\hyperlink{class_formula}{Formula}} *formula = it-\/>second;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00355}00355     formula-\/>\mbox{\hyperlink{class_formula_ad6f4bcbc9d72789367acac83a3ea6846}{setWidth}}(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}((\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_acf9f5399062fd8bf1dde083f15dcd1fc}{x2}}-\/\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a97fcb0e1731b36905e90757f211b1340}{x1}})*scaleFactor+0.5));}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00356}00356     formula-\/>\mbox{\hyperlink{class_formula_aa98f77319800a11b67fc2be1a2b5f0d4}{setHeight}}(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}((\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_aa7986c9249de185e59245a0f83431db9}{y2}}-\/\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a460698fb30c144b9b1a9508012ef1e43}{y1}})*scaleFactor+0.5));}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00357}00357   \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00358}00358   \textcolor{keywordflow}{return} scaleFactor;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00359}00359 \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00360}00360 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00361}\mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_a751decfa83144bf64f1cd1cb492db3fe}{00361}} \textcolor{keyword}{static} \textcolor{keywordtype}{bool} \mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_a751decfa83144bf64f1cd1cb492db3fe}{createCroppedPDF}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_q_c_string}{QCString}} \&formBase,\textcolor{keywordtype}{int} \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a97fcb0e1731b36905e90757f211b1340}{x1}},\textcolor{keywordtype}{int} \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a460698fb30c144b9b1a9508012ef1e43}{y1}},\textcolor{keywordtype}{int} \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_acf9f5399062fd8bf1dde083f15dcd1fc}{x2}},\textcolor{keywordtype}{int} \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_aa7986c9249de185e59245a0f83431db9}{y2}})}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00362}00362 \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00363}00363   \textcolor{keywordtype}{char} args[4096];}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00364}00364   \textcolor{comment}{// crop the image to its bounding box}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00365}00365   sprintf(args,\textcolor{stringliteral}{"{}-\/q -\/dBATCH -\/dNOPAUSE -\/P-\/ -\/dNOSAFER -\/sDEVICE=pdfwrite"{}}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00366}00366               \textcolor{stringliteral}{"{} -\/o \%s\_tmp.pdf -\/c \(\backslash\)"{}[/CropBox [\%d \%d \%d \%d] /PAGES pdfmark\(\backslash\)"{} -\/f \%s\_tmp.ps"{}},}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00367}00367       \mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(formBase),\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a97fcb0e1731b36905e90757f211b1340}{x1}},\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a460698fb30c144b9b1a9508012ef1e43}{y1}},\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_acf9f5399062fd8bf1dde083f15dcd1fc}{x2}},\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_aa7986c9249de185e59245a0f83431db9}{y2}},\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(formBase));}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00368}00368   \mbox{\hyperlink{namespace_portable_ada9653ce1cfc72cc4923aac726435962}{Portable::sysTimerStart}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00369}00369   \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespace_portable_ab30a636186b72a67d57e9f7f1e917e99}{Portable::system}}(\mbox{\hyperlink{namespace_portable_a4c4c43977edb27e33f873fbacf11d528}{Portable::ghostScriptCommand}}(),args)!=0)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00370}00370   \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00371}00371     \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_aede5746344fdce99647541101eaa7f06}{err}}(\textcolor{stringliteral}{"{}Problems running \%s. Check your installation!\(\backslash\)n"{}},\mbox{\hyperlink{namespace_portable_a4c4c43977edb27e33f873fbacf11d528}{Portable::ghostScriptCommand}}());}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00372}00372     \mbox{\hyperlink{namespace_portable_a3131c9d07ca7ce1ad22542ce9e417068}{Portable::sysTimerStop}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00373}00373     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00374}00374   \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00375}00375   \mbox{\hyperlink{namespace_portable_a3131c9d07ca7ce1ad22542ce9e417068}{Portable::sysTimerStop}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00376}00376   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00377}00377 \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00378}00378 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00379}\mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_a322962831f30dce16a3323a67d6e2c44}{00379}} \textcolor{keyword}{static} \textcolor{keywordtype}{bool} \mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_a322962831f30dce16a3323a67d6e2c44}{createCroppedEPS}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_q_c_string}{QCString}} \&formBase)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00380}00380 \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00381}00381   \textcolor{keywordtype}{char} args[4096];}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00382}00382   \textcolor{comment}{// crop the image to its bounding box}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00383}00383   sprintf(args,\textcolor{stringliteral}{"{}-\/q -\/dBATCH -\/dNOPAUSE -\/P-\/ -\/dNOSAFER -\/sDEVICE=eps2write"{}}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00384}00384               \textcolor{stringliteral}{"{} -\/o \%s\_tmp.eps -\/f \%s\_tmp.ps"{}},\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(formBase),\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(formBase));}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00385}00385   \mbox{\hyperlink{namespace_portable_ada9653ce1cfc72cc4923aac726435962}{Portable::sysTimerStart}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00386}00386   \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespace_portable_ab30a636186b72a67d57e9f7f1e917e99}{Portable::system}}(\mbox{\hyperlink{namespace_portable_a4c4c43977edb27e33f873fbacf11d528}{Portable::ghostScriptCommand}}(),args)!=0)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00387}00387   \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00388}00388     \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_aede5746344fdce99647541101eaa7f06}{err}}(\textcolor{stringliteral}{"{}Problems running \%s. Check your installation!\(\backslash\)n"{}},\mbox{\hyperlink{namespace_portable_a4c4c43977edb27e33f873fbacf11d528}{Portable::ghostScriptCommand}}());}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00389}00389     \mbox{\hyperlink{namespace_portable_a3131c9d07ca7ce1ad22542ce9e417068}{Portable::sysTimerStop}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00390}00390     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00391}00391   \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00392}00392   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00393}00393 \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00394}00394 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00395}\mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_ad88d54d53a499dad6fda6617d2dc952e}{00395}} \textcolor{keyword}{static} \textcolor{keywordtype}{bool} \mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_ad88d54d53a499dad6fda6617d2dc952e}{createSVGFromPDF}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_q_c_string}{QCString}} \&formBase,\textcolor{keyword}{const} \mbox{\hyperlink{class_q_c_string}{QCString}} \&\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a9af8a34a1d63fa9ed984b7cdd97daee1}{outFile}})}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00396}00396 \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00397}00397   \textcolor{keywordtype}{char} args[4096];}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00398}00398   sprintf(args,\textcolor{stringliteral}{"{}\%s\_tmp.pdf \%s"{}},\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(formBase),\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a9af8a34a1d63fa9ed984b7cdd97daee1}{outFile}}));}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00399}00399   \mbox{\hyperlink{namespace_portable_ada9653ce1cfc72cc4923aac726435962}{Portable::sysTimerStart}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00400}00400   \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespace_portable_ab30a636186b72a67d57e9f7f1e917e99}{Portable::system}}(\textcolor{stringliteral}{"{}pdf2svg"{}},args)!=0)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00401}00401   \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00402}00402     \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_aede5746344fdce99647541101eaa7f06}{err}}(\textcolor{stringliteral}{"{}Problems running pdf2svg. Check your installation!\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00403}00403     \mbox{\hyperlink{namespace_portable_a3131c9d07ca7ce1ad22542ce9e417068}{Portable::sysTimerStop}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00404}00404     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00405}00405   \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00406}00406   \mbox{\hyperlink{namespace_portable_a3131c9d07ca7ce1ad22542ce9e417068}{Portable::sysTimerStop}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00407}00407   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00408}00408 \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00409}00409 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00410}\mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_a4a9f805d74ef5c5e0e38427ccf5719f7}{00410}} \textcolor{keyword}{static} \textcolor{keywordtype}{bool} \mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_a4a9f805d74ef5c5e0e38427ccf5719f7}{createSVGFromPDFviaInkscape}}(\mbox{\hyperlink{class_dir}{Dir}} \&thisDir,\textcolor{keyword}{const} \mbox{\hyperlink{class_q_c_string}{QCString}} \&formBase,\textcolor{keyword}{const} \mbox{\hyperlink{class_q_c_string}{QCString}} \&\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a9af8a34a1d63fa9ed984b7cdd97daee1}{outFile}})}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00411}00411 \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00412}00412   \textcolor{keywordtype}{char} args[4096];}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00413}00413   \textcolor{keywordtype}{int} inkscapeVersion = \mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_a1882de11e1ccd91da1167ed471d1add5}{determineInkscapeVersion}}(thisDir);}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00414}00414   \textcolor{keywordflow}{if} (inkscapeVersion == -\/1)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00415}00415   \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00416}00416     \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_aede5746344fdce99647541101eaa7f06}{err}}(\textcolor{stringliteral}{"{}Problems determining the version of inkscape. Check your installation!\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00417}00417     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00418}00418   \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00419}00419   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (inkscapeVersion == 0)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00420}00420   \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00421}00421     sprintf(args,\textcolor{stringliteral}{"{}-\/l \%s -\/z \%s\_tmp.pdf 2>\%s"{}},\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a9af8a34a1d63fa9ed984b7cdd97daee1}{outFile}}),\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(formBase),\mbox{\hyperlink{namespace_portable_aec45ff95f54eed28050e42d3638907cf}{Portable::devNull}}());}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00422}00422   \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00423}00423   \textcolor{keywordflow}{else} \textcolor{comment}{// inkscapeVersion >= 1}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00424}00424   \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00425}00425     sprintf(args,\textcolor{stringliteral}{"{}-\/-\/export-\/type=svg -\/-\/export-\/filename=\%s \%s\_tmp.pdf 2>\%s"{}},\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a9af8a34a1d63fa9ed984b7cdd97daee1}{outFile}}),\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(formBase),\mbox{\hyperlink{namespace_portable_aec45ff95f54eed28050e42d3638907cf}{Portable::devNull}}());}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00426}00426   \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00427}00427   \mbox{\hyperlink{namespace_portable_ada9653ce1cfc72cc4923aac726435962}{Portable::sysTimerStart}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00428}00428   \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespace_portable_ab30a636186b72a67d57e9f7f1e917e99}{Portable::system}}(\textcolor{stringliteral}{"{}inkscape"{}},args)!=0)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00429}00429   \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00430}00430     \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_aede5746344fdce99647541101eaa7f06}{err}}(\textcolor{stringliteral}{"{}Problems running inkscape. Check your installation!\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00431}00431     \mbox{\hyperlink{namespace_portable_a3131c9d07ca7ce1ad22542ce9e417068}{Portable::sysTimerStop}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00432}00432     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00433}00433   \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00434}00434   \mbox{\hyperlink{namespace_portable_a3131c9d07ca7ce1ad22542ce9e417068}{Portable::sysTimerStop}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00435}00435   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00436}00436 \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00437}00437 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00438}00438 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00439}\mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_afa25bb4d45f6063809f1c8cd70038d94}{00439}} \textcolor{keyword}{static} \textcolor{keywordtype}{bool} \mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_afa25bb4d45f6063809f1c8cd70038d94}{updateEPSBoundingBox}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_q_c_string}{QCString}} \&formBase,}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00440}00440                                  \textcolor{keywordtype}{int} \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a97fcb0e1731b36905e90757f211b1340}{x1}},\textcolor{keywordtype}{int} \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a460698fb30c144b9b1a9508012ef1e43}{y1}},\textcolor{keywordtype}{int} \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_acf9f5399062fd8bf1dde083f15dcd1fc}{x2}},\textcolor{keywordtype}{int} \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_aa7986c9249de185e59245a0f83431db9}{y2}},}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00441}00441                                  \textcolor{keywordtype}{double} x1hi,\textcolor{keywordtype}{double} y1hi,\textcolor{keywordtype}{double} x2hi,\textcolor{keywordtype}{double} y2hi)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00442}00442 \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00443}00443   \textcolor{comment}{// read back \%s\_tmp.eps and replace}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00444}00444   \textcolor{comment}{// bounding box values with x1,y1,x2,y2 and remove the HiResBoundingBox}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00445}00445   \mbox{\hyperlink{namespaceghc_1_1filesystem_ac5ce4cc34ef910b06b64f6110c866e2e}{std::ifstream}} epsIn(formBase.\mbox{\hyperlink{class_q_c_string_a875e9ad762554ef12f3ed69b015bb245}{str}}()+\textcolor{stringliteral}{"{}\_tmp.eps"{}},std::ifstream::in);}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00446}00446   \mbox{\hyperlink{namespaceghc_1_1filesystem_a5a9df37f9ba2cf3b2dabb4a221b71b09}{std::ofstream}} epsOut(formBase.\mbox{\hyperlink{class_q_c_string_a875e9ad762554ef12f3ed69b015bb245}{str}}()+\textcolor{stringliteral}{"{}\_tmp\_corr.eps"{}},\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a48bc11919b2752df9d14ce89557cfb25}{std::ofstream::out}} | std::ofstream::binary);}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00447}00447   \textcolor{keywordflow}{if} (epsIn.is\_open() \&\& epsOut.is\_open())}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00448}00448   \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00449}00449     \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_ab316628fa3d58332c1756353c49316c1}{std::string}} line;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00450}00450     \textcolor{keywordflow}{while} (getline(epsIn,line))}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00451}00451     \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00452}00452       \textcolor{keywordflow}{if} (line.rfind(\textcolor{stringliteral}{"{}\%\%BoundingBox"{}},0)==0)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00453}00453       \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00454}00454         epsOut << \textcolor{stringliteral}{"{}\%\%BoundingBox: "{}} << \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a97fcb0e1731b36905e90757f211b1340}{x1}} << \textcolor{stringliteral}{"{} "{}} << \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a460698fb30c144b9b1a9508012ef1e43}{y1}} << \textcolor{stringliteral}{"{} "{}} << \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_acf9f5399062fd8bf1dde083f15dcd1fc}{x2}} << \textcolor{stringliteral}{"{} "{}} << \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_aa7986c9249de185e59245a0f83431db9}{y2}} << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00455}00455       \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00456}00456       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (line.rfind(\textcolor{stringliteral}{"{}\%\%HiResBoundingBox"{}},0)==0)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00457}00457       \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00458}00458         epsOut << \textcolor{stringliteral}{"{}\%\%HiResBoundingBox: "{}} << x1hi << \textcolor{stringliteral}{"{} "{}} << y1hi << \textcolor{stringliteral}{"{} "{}} << x2hi << \textcolor{stringliteral}{"{} "{}} << y2hi << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00459}00459       \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00460}00460       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00461}00461       \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00462}00462         epsOut << line << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00463}00463       \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00464}00464     \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00465}00465     epsIn.close();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00466}00466     epsOut.close();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00467}00467   \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00468}00468   \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00469}00469   \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00470}00470     \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_aede5746344fdce99647541101eaa7f06}{err}}(\textcolor{stringliteral}{"{}Problems correcting the eps files from \%s\_tmp.eps to \%s\_tmp\_corr.eps\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00471}00471         \mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(formBase),\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(formBase));}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00472}00472     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00473}00473   \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00474}00474   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00475}00475 \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00476}00476 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00477}\mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_a0cc00317e5a4482a2e7df401bd480f38}{00477}} \textcolor{keyword}{static} \textcolor{keywordtype}{bool} \mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_a0cc00317e5a4482a2e7df401bd480f38}{createPNG}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_q_c_string}{QCString}} \&formBase,\textcolor{keyword}{const} \mbox{\hyperlink{class_q_c_string}{QCString}} \&\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a9af8a34a1d63fa9ed984b7cdd97daee1}{outFile}},\textcolor{keywordtype}{double} scaleFactor)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00478}00478 \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00479}00479   \textcolor{keywordtype}{char} args[4096];}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00480}00480   \mbox{\hyperlink{namespace_portable_a3131c9d07ca7ce1ad22542ce9e417068}{Portable::sysTimerStop}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00481}00481   sprintf(args,\textcolor{stringliteral}{"{}-\/q -\/dNOSAFER -\/dBATCH -\/dNOPAUSE -\/dEPSCrop -\/sDEVICE=pnggray -\/dGraphicsAlphaBits=4 -\/dTextAlphaBits=4 "{}}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00482}00482                \textcolor{stringliteral}{"{}-\/r\%d -\/sOutputFile=\%s \%s\_tmp\_corr.eps"{}},\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(scaleFactor*72),\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a9af8a34a1d63fa9ed984b7cdd97daee1}{outFile}}),\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(formBase));}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00483}00483   \mbox{\hyperlink{namespace_portable_ada9653ce1cfc72cc4923aac726435962}{Portable::sysTimerStart}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00484}00484   \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespace_portable_ab30a636186b72a67d57e9f7f1e917e99}{Portable::system}}(\mbox{\hyperlink{namespace_portable_a4c4c43977edb27e33f873fbacf11d528}{Portable::ghostScriptCommand}}(),args)!=0)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00485}00485   \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00486}00486     \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_aede5746344fdce99647541101eaa7f06}{err}}(\textcolor{stringliteral}{"{}Problems running \%s. Check your installation!\(\backslash\)n"{}},\mbox{\hyperlink{namespace_portable_a4c4c43977edb27e33f873fbacf11d528}{Portable::ghostScriptCommand}}());}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00487}00487     \mbox{\hyperlink{namespace_portable_a3131c9d07ca7ce1ad22542ce9e417068}{Portable::sysTimerStop}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00488}00488     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00489}00489   \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00490}00490   \mbox{\hyperlink{namespace_portable_a3131c9d07ca7ce1ad22542ce9e417068}{Portable::sysTimerStop}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00491}00491   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00492}00492 \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00493}00493 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00494}\mbox{\hyperlink{class_formula_manager_ab24723d7cedd2c780f895fea971fb484}{00494}} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_formula_manager_ab24723d7cedd2c780f895fea971fb484}{FormulaManager::createFormulasTexFile}}(\mbox{\hyperlink{class_dir}{Dir}} \&thisDir,\mbox{\hyperlink{class_formula_manager_aa538ca4ffea4dd937920ebdd41222e69}{Format}} format,\mbox{\hyperlink{class_formula_manager_ae7fe54b64ef2fa9eff2494118fab761e}{HighDPI}} hd,\mbox{\hyperlink{class_formula_manager_a417a154a8ce0abdc51353d4475005419}{Mode}} \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_adfd79db267a2c3b3684968e06c3b9155}{mode}})}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00495}00495 \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00496}00496   \mbox{\hyperlink{build_2doxygen_2src_2containers_8h_a0b244579717fb04b2fb4ac89ee2f0f35}{IntVector}} formulasToGenerate;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00497}00497   \mbox{\hyperlink{class_q_c_string}{QCString}} formulaFileName = \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_adfd79db267a2c3b3684968e06c3b9155}{mode}}==\mbox{\hyperlink{class_formula_manager_a417a154a8ce0abdc51353d4475005419a9914a0ce04a7b7b6a8e39bec55064b82}{Mode::Light}} ? \textcolor{stringliteral}{"{}\_formulas"{}} : \textcolor{stringliteral}{"{}\_formulas\_dark"{}};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00498}00498   \mbox{\hyperlink{class_formula_manager_a0f96928dbcf6279d70d38ee11b35ea55}{createLatexFile}}(formulaFileName,format,\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_adfd79db267a2c3b3684968e06c3b9155}{mode}},formulasToGenerate);}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00499}00499 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00500}00500   \textcolor{keywordflow}{if} (!formulasToGenerate.empty()) \textcolor{comment}{// there are new formulas}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00501}00501   \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00502}00502     \textcolor{keywordflow}{if} (!\mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_a704ccf2352fafe16ddf093abbaa6f7b4}{createDVIFile}}(formulaFileName)) \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00503}00503 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00504}00504     \textcolor{comment}{//printf("{}Running dvips...\(\backslash\)n"{});}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00505}00505     \textcolor{keywordtype}{int} pageIndex=1;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00506}00506     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} pageNum : formulasToGenerate)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00507}00507     \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00508}00508       \mbox{\hyperlink{class_q_c_string}{QCString}} outputFile;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00509}00509       outputFile.\mbox{\hyperlink{class_q_c_string_aa2dccf89cb25346c3ee81d75aa5859da}{sprintf}}(\textcolor{stringliteral}{"{}form\_\%d\%s.\%s"{}},pageNum, \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_adfd79db267a2c3b3684968e06c3b9155}{mode}}==\mbox{\hyperlink{class_formula_manager_a417a154a8ce0abdc51353d4475005419a9914a0ce04a7b7b6a8e39bec55064b82}{Mode::Light}}?\textcolor{stringliteral}{"{}"{}}:\textcolor{stringliteral}{"{}\_dark"{}}, format==\mbox{\hyperlink{class_formula_manager_aa538ca4ffea4dd937920ebdd41222e69a57dea6f5039281b7fee517fc43bf3110}{Format::Vector}}?\textcolor{stringliteral}{"{}svg"{}}:\textcolor{stringliteral}{"{}png"{}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00510}00510       \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_aba549a028419cd48a3f373037c2c57eb}{msg}}(\textcolor{stringliteral}{"{}Generating image \%s for formula\(\backslash\)n"{}},\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(outputFile));}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00511}00511 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00512}00512       \mbox{\hyperlink{class_q_c_string}{QCString}} formBase;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00513}00513       formBase.\mbox{\hyperlink{class_q_c_string_aa2dccf89cb25346c3ee81d75aa5859da}{sprintf}}(\textcolor{stringliteral}{"{}\_form\%d\%s"{}},pageNum,\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_adfd79db267a2c3b3684968e06c3b9155}{mode}}==\mbox{\hyperlink{class_formula_manager_a417a154a8ce0abdc51353d4475005419a9914a0ce04a7b7b6a8e39bec55064b82}{Mode::Light}}?\textcolor{stringliteral}{"{}"{}}:\textcolor{stringliteral}{"{}\_dark"{}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00514}00514 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00515}00515       \textcolor{keywordflow}{if} (!\mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_a57b6802045cb92594d1f65e5b8821456}{createPostscriptFile}}(formulaFileName,formBase,pageIndex)) \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00516}00516 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00517}00517       \textcolor{keywordtype}{int} \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a97fcb0e1731b36905e90757f211b1340}{x1}}=0,\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a460698fb30c144b9b1a9508012ef1e43}{y1}}=0,\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_acf9f5399062fd8bf1dde083f15dcd1fc}{x2}}=0,\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_aa7986c9249de185e59245a0f83431db9}{y2}}=0;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00518}00518       \textcolor{keywordtype}{double} x1hi=0.0,y1hi=0.0,x2hi=0.0,y2hi=0.0;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00519}00519       \textcolor{keywordflow}{if} (\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_adfd79db267a2c3b3684968e06c3b9155}{mode}}==\mbox{\hyperlink{class_formula_manager_a417a154a8ce0abdc51353d4475005419a9914a0ce04a7b7b6a8e39bec55064b82}{Mode::Light}})}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00520}00520       \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00521}00521         \textcolor{keywordflow}{if} (!\mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_a92954fc40f0e05879c1726f8d8207b1f}{createEPSbboxFile}}(formBase)) \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00522}00522         \textcolor{comment}{// extract the bounding box info from the generated .epsi file}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00523}00523         \textcolor{keywordflow}{if} (!\mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_ac7978878c5e2989e9739423aa06f805a}{extractBoundingBox}}(formBase,\&\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a97fcb0e1731b36905e90757f211b1340}{x1}},\&\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a460698fb30c144b9b1a9508012ef1e43}{y1}},\&\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_acf9f5399062fd8bf1dde083f15dcd1fc}{x2}},\&\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_aa7986c9249de185e59245a0f83431db9}{y2}},\&x1hi,\&y1hi,\&x2hi,\&y2hi)) \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00524}00524       \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00525}00525       \textcolor{keywordflow}{else} \textcolor{comment}{// for dark images the bounding box is wrong (includes the black) so}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00526}00526            \textcolor{comment}{// use the bounding box of the light image instead.}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00527}00527       \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00528}00528         \mbox{\hyperlink{class_q_c_string}{QCString}} formBaseLight;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00529}00529         formBaseLight.\mbox{\hyperlink{class_q_c_string_aa2dccf89cb25346c3ee81d75aa5859da}{sprintf}}(\textcolor{stringliteral}{"{}\_form\%d"{}},pageNum);}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00530}00530         \textcolor{keywordflow}{if} (!\mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_ac7978878c5e2989e9739423aa06f805a}{extractBoundingBox}}(formBaseLight,\&\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a97fcb0e1731b36905e90757f211b1340}{x1}},\&\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a460698fb30c144b9b1a9508012ef1e43}{y1}},\&\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_acf9f5399062fd8bf1dde083f15dcd1fc}{x2}},\&\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_aa7986c9249de185e59245a0f83431db9}{y2}},\&x1hi,\&y1hi,\&x2hi,\&y2hi)) \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00531}00531       \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00532}00532 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00533}00533       \textcolor{comment}{// convert the corrected EPS to a bitmap}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00534}00534       \textcolor{keywordtype}{double} scaleFactor = \mbox{\hyperlink{class_formula_manager_a70aa26f8a815b1f65663e06a2af49bb7}{updateFormulaSize}}(pageNum,\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a97fcb0e1731b36905e90757f211b1340}{x1}},\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a460698fb30c144b9b1a9508012ef1e43}{y1}},\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_acf9f5399062fd8bf1dde083f15dcd1fc}{x2}},\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_aa7986c9249de185e59245a0f83431db9}{y2}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00535}00535 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00536}00536       \textcolor{keywordflow}{if} (format==\mbox{\hyperlink{class_formula_manager_aa538ca4ffea4dd937920ebdd41222e69a57dea6f5039281b7fee517fc43bf3110}{Format::Vector}})}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00537}00537       \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00538}00538         \textcolor{keywordflow}{if} (!\mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_a751decfa83144bf64f1cd1cb492db3fe}{createCroppedPDF}}(formBase,\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a97fcb0e1731b36905e90757f211b1340}{x1}},\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a460698fb30c144b9b1a9508012ef1e43}{y1}},\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_acf9f5399062fd8bf1dde083f15dcd1fc}{x2}},\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_aa7986c9249de185e59245a0f83431db9}{y2}})) \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00539}00539 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00540}00540         \textcolor{comment}{// if we have pdf2svg available use it to create a SVG image}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00541}00541         \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespace_portable_a39228795dec07d8121645b0348e91712}{Portable::checkForExecutable}}(\textcolor{stringliteral}{"{}pdf2svg"{}}))}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00542}00542         \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00543}00543           \mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_ad88d54d53a499dad6fda6617d2dc952e}{createSVGFromPDF}}(formBase,outputFile);}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00544}00544         \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00545}00545         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespace_portable_a39228795dec07d8121645b0348e91712}{Portable::checkForExecutable}}(\textcolor{stringliteral}{"{}inkscape"{}})) \textcolor{comment}{// alternative is to use inkscape}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00546}00546         \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00547}00547           \mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_a4a9f805d74ef5c5e0e38427ccf5719f7}{createSVGFromPDFviaInkscape}}(thisDir,formBase,outputFile);}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00548}00548         \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00549}00549         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00550}00550         \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00551}00551           \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_aede5746344fdce99647541101eaa7f06}{err}}(\textcolor{stringliteral}{"{}Neither 'pdf2svg' nor 'inkscape' present for conversion of formula to 'svg'\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00552}00552           \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00553}00553         \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00554}00554 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00555}00555         \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>tempFiles.push\_back(formBase.\mbox{\hyperlink{class_q_c_string_a875e9ad762554ef12f3ed69b015bb245}{str}}()+\textcolor{stringliteral}{"{}\_tmp.pdf"{}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00556}00556       \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00557}00557       \textcolor{keywordflow}{else} \textcolor{comment}{// format==Format::Bitmap}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00558}00558       \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00559}00559         \textcolor{keywordflow}{if} (!\mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_a322962831f30dce16a3323a67d6e2c44}{createCroppedEPS}}(formBase)) \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00560}00560 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00561}00561         \textcolor{keywordflow}{if} (!\mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_afa25bb4d45f6063809f1c8cd70038d94}{updateEPSBoundingBox}}(formBase,\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a97fcb0e1731b36905e90757f211b1340}{x1}},\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a460698fb30c144b9b1a9508012ef1e43}{y1}},\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_acf9f5399062fd8bf1dde083f15dcd1fc}{x2}},\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_aa7986c9249de185e59245a0f83431db9}{y2}},x1hi,y1hi,x2hi,y2hi)) \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00562}00562 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00563}00563         \textcolor{keywordflow}{if} (hd==\mbox{\hyperlink{class_formula_manager_ae7fe54b64ef2fa9eff2494118fab761ea521c36a31c2762741cf0f8890cbe05e3}{HighDPI::On}}) \textcolor{comment}{// for high DPI display it looks much better if the}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00564}00564                              \textcolor{comment}{// image resolution is higher than the display resolution}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00565}00565         \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00566}00566           scaleFactor*=2;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00567}00567         \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00568}00568 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00569}00569         \textcolor{keywordflow}{if} (!\mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_a0cc00317e5a4482a2e7df401bd480f38}{createPNG}}(formBase,outputFile,scaleFactor)) \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00570}00570 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00571}00571         \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>tempFiles.push\_back(formBase.\mbox{\hyperlink{class_q_c_string_a875e9ad762554ef12f3ed69b015bb245}{str}}()+\textcolor{stringliteral}{"{}\_tmp.eps"{}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00572}00572         \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>tempFiles.push\_back(formBase.\mbox{\hyperlink{class_q_c_string_a875e9ad762554ef12f3ed69b015bb245}{str}}()+\textcolor{stringliteral}{"{}\_tmp\_corr.eps"{}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00573}00573       \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00574}00574 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00575}00575       \textcolor{comment}{// remove intermediate image files}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00576}00576       \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>tempFiles.push\_back(formBase.\mbox{\hyperlink{class_q_c_string_a875e9ad762554ef12f3ed69b015bb245}{str}}()+\textcolor{stringliteral}{"{}\_tmp.ps"{}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00577}00577       \textcolor{keywordflow}{if} (\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_adfd79db267a2c3b3684968e06c3b9155}{mode}}==\mbox{\hyperlink{class_formula_manager_a417a154a8ce0abdc51353d4475005419a9914a0ce04a7b7b6a8e39bec55064b82}{Mode::Light}})}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00578}00578       \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00579}00579         \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>tempFiles.push\_back(formBase.\mbox{\hyperlink{class_q_c_string_a875e9ad762554ef12f3ed69b015bb245}{str}}()+\textcolor{stringliteral}{"{}\_tmp.epsi"{}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00580}00580       \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00581}00581       pageIndex++;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00582}00582     \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00583}00583     \textcolor{comment}{// remove intermediate files produced by latex}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00584}00584     \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>tempFiles.push\_back(formulaFileName.\mbox{\hyperlink{class_q_c_string_a875e9ad762554ef12f3ed69b015bb245}{str}}()+\textcolor{stringliteral}{"{}.dvi"{}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00585}00585     \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>tempFiles.push\_back(formulaFileName.\mbox{\hyperlink{class_q_c_string_a875e9ad762554ef12f3ed69b015bb245}{str}}()+\textcolor{stringliteral}{"{}.log"{}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00586}00586     \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>tempFiles.push\_back(formulaFileName.\mbox{\hyperlink{class_q_c_string_a875e9ad762554ef12f3ed69b015bb245}{str}}()+\textcolor{stringliteral}{"{}.aux"{}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00587}00587   \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00588}00588   \textcolor{comment}{// remove the latex file itself}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00589}00589   \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>tempFiles.push\_back(formulaFileName.\mbox{\hyperlink{class_q_c_string_a875e9ad762554ef12f3ed69b015bb245}{str}}()+\textcolor{stringliteral}{"{}.tex"{}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00590}00590 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00591}00591   \textcolor{comment}{// write/update the formula repository so we know what text the}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00592}00592   \textcolor{comment}{// generated images represent (we use this next time to avoid regeneration}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00593}00593   \textcolor{comment}{// of the images, and to avoid forcing the user to delete all images in order}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00594}00594   \textcolor{comment}{// to let a browser refresh the images).}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00595}00595   \mbox{\hyperlink{namespaceghc_1_1filesystem_a5a9df37f9ba2cf3b2dabb4a221b71b09}{std::ofstream}} \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00596}00596   \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}}.open(\textcolor{stringliteral}{"{}formula.repository"{}},\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a48bc11919b2752df9d14ce89557cfb25}{std::ofstream::out}} | std::ofstream::binary);}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00597}00597   \textcolor{keywordflow}{if} (\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}}.is\_open())}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00598}00598   \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00599}00599     \mbox{\hyperlink{class_text_stream}{TextStream}} t(\&\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a26bd95fde4dbe225dd861231581fc268}{f}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00600}00600     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&formula : \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>formulas)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00601}00601     \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00602}00602       t << \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)\_form\#"{}} << formula-\/>id();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00603}00603       \textcolor{keywordflow}{if} (formula-\/>width()!=-\/1 \&\& formula-\/>height()!=-\/1)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00604}00604       \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00605}00605         t << \textcolor{stringliteral}{"{}="{}} << formula-\/>width() << \textcolor{stringliteral}{"{}x"{}} << formula-\/>height();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00606}00606       \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00607}00607       t << \textcolor{stringliteral}{"{}:"{}} << formula-\/>text() << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00608}00608     \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00609}00609   \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00610}00610 \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00611}00611 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00612}\mbox{\hyperlink{class_formula_manager_aef1d730d619e5441ab6206a8fd5b1a45}{00612}} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_formula_manager_aef1d730d619e5441ab6206a8fd5b1a45}{FormulaManager::generateImages}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_q_c_string}{QCString}} \&path,\mbox{\hyperlink{class_formula_manager_aa538ca4ffea4dd937920ebdd41222e69}{Format}} format,\mbox{\hyperlink{class_formula_manager_ae7fe54b64ef2fa9eff2494118fab761e}{HighDPI}} hd)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00613}00613 \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00614}00614   \mbox{\hyperlink{class_dir}{Dir}} d(path.\mbox{\hyperlink{class_q_c_string_a875e9ad762554ef12f3ed69b015bb245}{str}}());}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00615}00615   \textcolor{comment}{// store the original directory}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00616}00616   \textcolor{keywordflow}{if} (!d.\mbox{\hyperlink{class_dir_ac6bf80b5b3a034e8c144c86ef48ae309}{exists}}())}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00617}00617   \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00618}00618     \mbox{\hyperlink{build_2doxygen_2src_2message_8cpp_ad8f29ff28015ffeb164a592dd68f89c7}{term}}(\textcolor{stringliteral}{"{}Output directory '\%s' does not exist!\(\backslash\)n"{}},\mbox{\hyperlink{build_2doxygen_2src_2qcstring_8h_a9851ebb5ae2f65b4d2b1d08421edbfd2}{qPrint}}(path));}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00619}00619   \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00620}00620   \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_ab316628fa3d58332c1756353c49316c1}{std::string}} oldDir = \mbox{\hyperlink{class_dir_a0f62ab07068c5f966bca7ce280f4ed49}{Dir::currentDirPath}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00621}00621 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00622}00622   \textcolor{comment}{// go to the html output directory (i.e. path)}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00623}00623   \mbox{\hyperlink{class_dir_ab3b09edc88159dc30426999bdc7d6d7b}{Dir::setCurrent}}(d.\mbox{\hyperlink{class_dir_a226b0db1117e46393bbb241e545f8609}{absPath}}());}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00624}00624   \mbox{\hyperlink{class_dir}{Dir}} thisDir;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00625}00625 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00626}00626   \mbox{\hyperlink{class_formula_manager_ab24723d7cedd2c780f895fea971fb484}{createFormulasTexFile}}(thisDir,format,hd,\mbox{\hyperlink{class_formula_manager_a417a154a8ce0abdc51353d4475005419a9914a0ce04a7b7b6a8e39bec55064b82}{Mode::Light}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00627}00627   \textcolor{keywordflow}{if} (\mbox{\hyperlink{build_2doxygen_2src_2config_8h_afe899eec751dfb75a60c37ec3840e288}{Config\_getEnum}}(HTML\_COLORSTYLE)!=HTML\_COLORSTYLE\_t::LIGHT) \textcolor{comment}{// all modes other than light need a dark version}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00628}00628   \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00629}00629     \textcolor{comment}{// note that the dark version reuses the bounding box of the light version so it needs to be}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00630}00630     \textcolor{comment}{// created after the light version.}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00631}00631     \mbox{\hyperlink{class_formula_manager_ab24723d7cedd2c780f895fea971fb484}{createFormulasTexFile}}(thisDir,format,hd,\mbox{\hyperlink{class_formula_manager_a417a154a8ce0abdc51353d4475005419aa18366b217ebf811ad1886e4f4f865b2}{Mode::Dark}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00632}00632   \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00633}00633 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00634}00634   \textcolor{comment}{// clean up temporary files}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00635}00635   \textcolor{keywordflow}{if} (\mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_a6e85eab155453f359a60e118e7e64fba}{RM\_TMP\_FILES}})}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00636}00636   \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00637}00637     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&\mbox{\hyperlink{namespacecaseconvert_ad3d65a3e98ad183dea4b1904045afa08}{file}} : \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>tempFiles)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00638}00638     \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00639}00639       thisDir.\mbox{\hyperlink{class_dir_a5a64060f8e1731e8f00da7e8f7051e4b}{remove}}(\mbox{\hyperlink{namespacecaseconvert_ad3d65a3e98ad183dea4b1904045afa08}{file}});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00640}00640     \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00641}00641   \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00642}00642 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00643}00643   \textcolor{comment}{// reset the directory to the original location.}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00644}00644   \mbox{\hyperlink{class_dir_ab3b09edc88159dc30426999bdc7d6d7b}{Dir::setCurrent}}(oldDir);}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00645}00645 \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00646}00646 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00647}\mbox{\hyperlink{class_formula_manager_a5a181349991e3e72a331b231c9c25f8b}{00647}} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_formula_manager_a5a181349991e3e72a331b231c9c25f8b}{FormulaManager::clear}}()}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00648}00648 \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00649}00649   \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>formulas.clear();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00650}00650   \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>formulaIdMap.clear();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00651}00651 \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00652}00652 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00653}\mbox{\hyperlink{class_formula_manager_a263c84263295a94dd1593d39f2c435f5}{00653}} \textcolor{keywordtype}{int} \mbox{\hyperlink{class_formula_manager_a263c84263295a94dd1593d39f2c435f5}{FormulaManager::addFormula}}(\textcolor{keyword}{const} \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_ab316628fa3d58332c1756353c49316c1}{std::string}} \&formulaText,\textcolor{keywordtype}{int} width,\textcolor{keywordtype}{int} height)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00654}00654 \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00655}00655   \mbox{\hyperlink{class_formula}{Formula}} *formula = \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>formulas.find(formulaText);}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00656}00656   \textcolor{keywordflow}{if} (formula) \textcolor{comment}{// same formula already stored}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00657}00657   \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00658}00658     \textcolor{keywordflow}{return} formula-\/>\mbox{\hyperlink{class_formula_ae4b7648ae0124da8456fa2c8e51991ba}{id}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00659}00659   \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00660}00660   \textcolor{comment}{// add new formula}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00661}00661   \textcolor{keywordtype}{int} \textcolor{keywordtype}{id} = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>formulas.size());}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00662}00662   formula = \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>formulas.add(formulaText.c\_str(),\mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a65841f8ec0ab4e93010736388282aada}{id}},width,height);}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00663}00663   \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>formulaIdMap.insert(std::make\_pair(\textcolor{keywordtype}{id},formula));}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00664}00664   \textcolor{keywordflow}{return} \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_a65841f8ec0ab4e93010736388282aada}{id}};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00665}00665 \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00666}00666 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00667}\mbox{\hyperlink{class_formula_manager_aa15bea658260218b4b6c3193df2c5856}{00667}} \textcolor{keyword}{const} \mbox{\hyperlink{class_formula}{Formula}} *\mbox{\hyperlink{class_formula_manager_aa15bea658260218b4b6c3193df2c5856}{FormulaManager::findFormula}}(\textcolor{keywordtype}{int} formulaId)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00668}00668 \textcolor{keyword}{}\{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00669}00669   \textcolor{keyword}{auto}   it  = \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>formulaIdMap.find(formulaId);}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00670}00670   \textcolor{keywordflow}{return} it != \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>formulaIdMap.end() ? it-\/>second : \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00671}00671 \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00672}00672 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00673}00673 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00674}00674 \mbox{\hyperlink{class_formula}{Formula}} *\mbox{\hyperlink{class_formula_manager_aa15bea658260218b4b6c3193df2c5856}{FormulaManager::findFormula}}(\textcolor{keywordtype}{int} formulaId)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00675}00675 \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00676}00676   \textcolor{keyword}{auto}   it  = \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>formulaIdMap.find(formulaId);}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00677}00677   \textcolor{keywordflow}{return} it != \mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>formulaIdMap.end() ? it-\/>second : \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00678}00678 \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00679}00679 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00680}00680 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00681}00681 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00682}\mbox{\hyperlink{class_formula_manager_a4b5c2d7e0c8001ae48514de0b468eb87}{00682}} \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_formula_manager_a4b5c2d7e0c8001ae48514de0b468eb87}{FormulaManager::hasFormulas}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00683}00683 \textcolor{keyword}{}\{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00684}00684   \textcolor{keywordflow}{return} !\mbox{\hyperlink{class_formula_manager_a7f877924c5f316b95f0b56d78871b379}{p}}-\/>formulas.empty();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00685}00685 \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00686}00686 }
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00687}00687 \textcolor{comment}{// helper function to detect and return the major version of inkscape.}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00688}00688 \textcolor{comment}{// return -\/1 if the version cannot be determined.}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00689}\mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_a1882de11e1ccd91da1167ed471d1add5}{00689}} \textcolor{keyword}{static} \textcolor{keywordtype}{int} \mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_a1882de11e1ccd91da1167ed471d1add5}{determineInkscapeVersion}}(\mbox{\hyperlink{class_dir}{Dir}} \&thisDir)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00690}00690 \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00691}00691   \textcolor{comment}{// The command line interface (CLI) of Inkscape 1.0 has changed in comparison to}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00692}00692   \textcolor{comment}{// previous versions. In order to invokine Inkscape, the used version is detected}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00693}00693   \textcolor{comment}{// and based on the version the right syntax of the CLI is chosen.}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00694}00694   \textcolor{keyword}{static} \textcolor{keywordtype}{int} inkscapeVersion = -\/2;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00695}00695   \textcolor{keywordflow}{if} (inkscapeVersion == -\/2) \textcolor{comment}{// initial one time version check}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00696}00696   \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00697}00697     \mbox{\hyperlink{class_q_c_string}{QCString}} inkscapeVersionFile = \textcolor{stringliteral}{"{}inkscape\_version"{}} ;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00698}00698     inkscapeVersion = -\/1;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00699}00699     \mbox{\hyperlink{class_q_c_string}{QCString}} args = \textcolor{stringliteral}{"{}-\/z -\/-\/version >"{}}+inkscapeVersionFile+\textcolor{stringliteral}{"{} 2>"{}}+\mbox{\hyperlink{namespace_portable_aec45ff95f54eed28050e42d3638907cf}{Portable::devNull}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00700}00700     \mbox{\hyperlink{namespace_portable_ada9653ce1cfc72cc4923aac726435962}{Portable::sysTimerStart}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00701}00701     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespace_portable_ab30a636186b72a67d57e9f7f1e917e99}{Portable::system}}(\textcolor{stringliteral}{"{}inkscape"{}},args)!=0)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00702}00702     \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00703}00703       \textcolor{comment}{// looks like the old syntax gave problems, lets try the new syntax}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00704}00704       args = \textcolor{stringliteral}{"{} -\/-\/version >"{}}+inkscapeVersionFile+\textcolor{stringliteral}{"{} 2>"{}}+\mbox{\hyperlink{namespace_portable_aec45ff95f54eed28050e42d3638907cf}{Portable::devNull}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00705}00705       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespace_portable_ab30a636186b72a67d57e9f7f1e917e99}{Portable::system}}(\textcolor{stringliteral}{"{}inkscape"{}},args)!=0)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00706}00706       \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00707}00707         \mbox{\hyperlink{namespace_portable_a3131c9d07ca7ce1ad22542ce9e417068}{Portable::sysTimerStop}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00708}00708         \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00709}00709       \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00710}00710     \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00711}00711     \textcolor{comment}{// read version file and determine major version}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00712}00712     \mbox{\hyperlink{namespaceghc_1_1filesystem_ac5ce4cc34ef910b06b64f6110c866e2e}{std::ifstream}} inkscapeVersionIn(inkscapeVersionFile.\mbox{\hyperlink{class_q_c_string_a875e9ad762554ef12f3ed69b015bb245}{str}}(),std::ifstream::in);}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00713}00713     \textcolor{keywordflow}{if} (inkscapeVersionIn.is\_open())}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00714}00714     \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00715}00715       \mbox{\hyperlink{build_2doxygen_2libmscgen_2gd_8h_ab316628fa3d58332c1756353c49316c1}{std::string}} line;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00716}00716       \textcolor{keywordflow}{while} (getline(inkscapeVersionIn,line))}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00717}00717       \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00718}00718         \textcolor{keywordtype}{size\_t} dotPos = line.find(\textcolor{charliteral}{'.'});}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00719}00719         \textcolor{keywordflow}{if} (line.rfind(\textcolor{stringliteral}{"{}Inkscape "{}},0)==0 \&\& dotPos>0)}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00720}00720         \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00721}00721           \textcolor{comment}{// get major version}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00722}00722           inkscapeVersion = std::stoi(line.substr(9,dotPos-\/9));}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00723}00723           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00724}00724         \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00725}00725       \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00726}00726       inkscapeVersionIn.close();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00727}00727     \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00728}00728     \textcolor{keywordflow}{else} \textcolor{comment}{// failed to open version file}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00729}00729     \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00730}00730       \mbox{\hyperlink{namespace_portable_a3131c9d07ca7ce1ad22542ce9e417068}{Portable::sysTimerStop}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00731}00731       \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00732}00732     \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00733}00733     \textcolor{keywordflow}{if} (\mbox{\hyperlink{build_2doxygen_2src_2formula_8cpp_a6e85eab155453f359a60e118e7e64fba}{RM\_TMP\_FILES}})}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00734}00734     \{}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00735}00735       thisDir.\mbox{\hyperlink{class_dir_a5a64060f8e1731e8f00da7e8f7051e4b}{remove}}(inkscapeVersionFile.\mbox{\hyperlink{class_q_c_string_a875e9ad762554ef12f3ed69b015bb245}{str}}());}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00736}00736     \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00737}00737     \mbox{\hyperlink{namespace_portable_a3131c9d07ca7ce1ad22542ce9e417068}{Portable::sysTimerStop}}();}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00738}00738   \}}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00739}00739   \textcolor{keywordflow}{return} inkscapeVersion;}
\DoxyCodeLine{\Hypertarget{build_2doxygen_2src_2formula_8cpp_source_l00740}00740 \}}

\end{DoxyCode}
